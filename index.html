<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/lib/pace/pace-theme-flash.min.css?v=1.0.2">





















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.1.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: true,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="再回首">
<meta property="og:url" content="https://www.ouscan.com/index.html">
<meta property="og:site_name" content="再回首">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="再回首">



  <link rel="alternate" href="/atom.xml" title="再回首" type="application/atom+xml">



  
  
  <link rel="canonical" href="https://www.ouscan.com/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>再回首</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>
	<a href="https://github.com/ouscan">
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">再回首</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">Develop with pleasure!</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-history"></i> <br>Archives</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-list"></i> <br>Categories</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>Search</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div>
    
 </div>
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.ouscan.com/uncategorized/CentOS7安装 jdk8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jaune lau">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="再回首">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/uncategorized/CentOS7安装 jdk8/" class="post-title-link" itemprop="url">CentOS7安装jdk8</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-05-15 16:48:43 / Modified: 17:04:21" itemprop="dateCreated datePublished" datetime="2019-05-15T16:48:43+08:00">2019-05-15</time>
            

            
              

              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="1-更新系统软件"><a href="#1-更新系统软件" class="headerlink" title="1.更新系统软件"></a>1.更新系统软件</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum update</span><br></pre></td></tr></table></figure>
<h5 id="2-查找系统已安装的jdk组件"><a href="#2-查找系统已安装的jdk组件" class="headerlink" title="2.查找系统已安装的jdk组件"></a>2.查找系统已安装的jdk组件</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa | grep -E &apos;^open[jre|jdk]|j[re|dk]&apos;</span><br></pre></td></tr></table></figure>
<h5 id="3-查看Java版本"><a href="#3-查看Java版本" class="headerlink" title="3.查看Java版本"></a>3.查看Java版本</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br></pre></td></tr></table></figure>
<h5 id="4-卸载以前已有的jdk"><a href="#4-卸载以前已有的jdk" class="headerlink" title="4.卸载以前已有的jdk"></a>4.卸载以前已有的jdk</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum remove java-1.6.0-openjdk</span><br><span class="line">yum remove java-1.7.0-openjdk</span><br></pre></td></tr></table></figure>
<h5 id="5-在-usr目录中新建名为java的文件夹"><a href="#5-在-usr目录中新建名为java的文件夹" class="headerlink" title="5.在/usr目录中新建名为java的文件夹"></a>5.在/usr目录中新建名为java的文件夹</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /usr/java</span><br></pre></td></tr></table></figure>
<h5 id="6-下载jdk-8u111-linux-x64-tar-gz包，并上传至服务器-usr-local文件夹中。"><a href="#6-下载jdk-8u111-linux-x64-tar-gz包，并上传至服务器-usr-local文件夹中。" class="headerlink" title="6.下载jdk-8u111-linux-x64.tar.gz包，并上传至服务器/usr/local文件夹中。"></a>6.下载jdk-8u111-linux-x64.tar.gz包，并上传至服务器/usr/local文件夹中。</h5><h5 id="7-解压jdk-8u111-linux-x64-tar-gz包至-usr-local-jdk1-8-0-111文件夹"><a href="#7-解压jdk-8u111-linux-x64-tar-gz包至-usr-local-jdk1-8-0-111文件夹" class="headerlink" title="7.解压jdk-8u111-linux-x64.tar.gz包至/usr/local/jdk1.8.0_111文件夹"></a>7.解压jdk-8u111-linux-x64.tar.gz包至/usr/local/jdk1.8.0_111文件夹</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xvf jdk-8u111-linux-x64.tar.gz</span><br></pre></td></tr></table></figure>
<h5 id="8-添加环境变量"><a href="#8-添加环境变量" class="headerlink" title="8.添加环境变量"></a>8.添加环境变量</h5><ul>
<li><p>编辑/etc/profile文件,添加如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#jdk</span><br><span class="line">export JAVA_HOME=/usr/local/jdk1.8.0_111</span><br><span class="line">export PATH=$JAVA_HOME/bin:$PATH</span><br><span class="line">export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行命令使配置生效</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="9-验证，是否安装成功"><a href="#9-验证，是否安装成功" class="headerlink" title="9.验证，是否安装成功"></a>9.验证，是否安装成功</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

	<div>
      
	</div>

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div>
    
 </div>
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.ouscan.com/docker/MySQL/CentOS7中Docker 安装 MySQL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jaune lau">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="再回首">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/docker/MySQL/CentOS7中Docker 安装 MySQL/" class="post-title-link" itemprop="url">CentOS7中Docker安装MySQL</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-05-15 16:42:28 / Modified: 17:34:58" itemprop="dateCreated datePublished" datetime="2019-05-15T16:42:28+08:00">2019-05-15</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/docker/" itemprop="url" rel="index"><span itemprop="name">docker</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/docker/MySQL/" itemprop="url" rel="index"><span itemprop="name">MySQL</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="1-创建mysql文件加"><a href="#1-创建mysql文件加" class="headerlink" title="1.创建mysql文件加"></a>1.创建mysql文件加</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /home/docker/mysql</span><br></pre></td></tr></table></figure>
<h5 id="2-查找Docker-Hub上mysql镜像"><a href="#2-查找Docker-Hub上mysql镜像" class="headerlink" title="2.查找Docker Hub上mysql镜像"></a>2.查找Docker Hub上mysql镜像</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@lau mysql]# docker search mysql</span><br><span class="line">NAME                     DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span><br><span class="line">mysql                    MySQL is a widely used, open-source relati...   2529      [OK]       </span><br><span class="line">mysql/mysql-server       Optimized MySQL Server Docker images. Crea...   161                  [OK]</span><br><span class="line">centurylink/mysql        Image containing mysql. Optimized to be li...   45                   [OK]</span><br><span class="line">sameersbn/mysql                                                          36                   [OK]</span><br><span class="line">google/mysql             MySQL server for Google Compute Engine          16                   [OK]</span><br><span class="line">appcontainers/mysql      Centos/Debian Based Customizable MySQL Con...   8                    [OK]</span><br><span class="line">marvambass/mysql         MySQL Server based on Ubuntu 14.04              6                    [OK]</span><br><span class="line">drupaldocker/mysql       MySQL for Drupal                                2                    [OK]</span><br><span class="line">azukiapp/mysql           Docker image to run MySQL by Azuki - http:...   2                    [OK]</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h5 id="3-拉取官方镜像，标签为5-6"><a href="#3-拉取官方镜像，标签为5-6" class="headerlink" title="3.拉取官方镜像，标签为5.6"></a>3.拉取官方镜像，标签为5.6</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@lau mysql]# docker pull mysql:5.6</span><br></pre></td></tr></table></figure>
<h5 id="4-运行容器"><a href="#4-运行容器" class="headerlink" title="4.运行容器"></a>4.运行容器</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@lau mysql]# docker run -p 3306:3306 --privileged=true -v /home/docker/mysql/logs:/logs -v /home/docker/mysql/data:/var/lib/mysql -v /home/docker/mysql/conf/my.cnf:/etc/my.cnf -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.6</span><br></pre></td></tr></table></figure>
<p>命令说明：</p>
<ul>
<li><strong>-p 3306:3306：</strong>将容器的3306端口映射到主机的3306端口</li>
<li><strong>-v /home/docker/mysql/conf/my.cnf:/etc/my.cnf：</strong>将主机当前目录下的etc/my.cnf挂载到容器的/home/docker/mysql/conf/my.cnf</li>
<li><strong>-v /home/docker/mysql/logs:/logs：</strong>将主机当前目录下的logs目录挂载到容器的/logs</li>
<li>-v /home/docker/mysql/data:/var/lib/mysql：**将主机当前目录下的data目录挂载到容器的/var/lib/mysql下</li>
<li><strong>-e MYSQL_ROOT_PASSWORD=123456：</strong>初始化root用户的密码</li>
</ul>
<h5 id="5-查看容器启动情况"><a href="#5-查看容器启动情况" class="headerlink" title="5.查看容器启动情况"></a>5.查看容器启动情况</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@lau mysql]# docker ps</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

	<div>
      
	</div>

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div>
    
 </div>
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.ouscan.com/docker/redis/CentOS7安装Docker安装Redis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jaune lau">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="再回首">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/docker/redis/CentOS7安装Docker安装Redis/" class="post-title-link" itemprop="url">CentOS7安装Docker安装Redis</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-05-14 16:42:28" itemprop="dateCreated datePublished" datetime="2019-05-14T16:42:28+08:00">2019-05-14</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-05-15 17:07:50" itemprop="dateModified" datetime="2019-05-15T17:07:50+08:00">2019-05-15</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/docker/" itemprop="url" rel="index"><span itemprop="name">docker</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/docker/redis/" itemprop="url" rel="index"><span itemprop="name">redis</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-、安装说明"><a href="#1-、安装说明" class="headerlink" title="1 、安装说明"></a>1 、安装说明</h4><p>Docker支持以下的CentOS版本：<br>CentOS 7 (64-bit)<br>CentOS 6.5 (64-bit) 或更高的版本</p>
<p>— 前提条件<br> 目前，CentOS 仅发行版本中的内核支持 Docker。<br> Docker 运行在 CentOS 7 上，要求系统为64位、系统内核版本为 3.10 以上。<br> Docker 运行在 CentOS-6.5 或更高的版本的 CentOS 上，要求系统为64位、系统内核版本为 2.6.32-431 或者更</p>
<h4 id="2、使用-yum-安装（CentOS-7下）"><a href="#2、使用-yum-安装（CentOS-7下）" class="headerlink" title="2、使用 yum 安装（CentOS 7下）"></a>2、使用 yum 安装（CentOS 7下）</h4><p>Docker 要求 CentOS 系统的内核版本高于 3.10 ，查看本页面的前提条件来验证你的CentOS 版本是否支持 Docker 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#查看你当前的内核版本</span><br><span class="line">uname -r</span><br><span class="line"></span><br><span class="line">#安装 Docker</span><br><span class="line">yum -y install docker</span><br><span class="line"></span><br><span class="line">#启动 Docker 后台服务</span><br><span class="line">service docker start</span><br><span class="line"></span><br><span class="line">#测试运行 hello-world,由于本地没有hello-world这个镜像，所以会下载一个hello-world的镜像，并在容器内运行。</span><br><span class="line">docker run hello-world</span><br></pre></td></tr></table></figure>
<h4 id="使用脚本安装-Docker"><a href="#使用脚本安装-Docker" class="headerlink" title="使用脚本安装 Docker"></a>使用脚本安装 Docker</h4><p>1、使用 sudo 或 root 权限登录 Centos。<br>2、确保 yum 包更新到最新。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#确保 yum 包更新到最新</span><br><span class="line">sudo yum update</span><br><span class="line"></span><br><span class="line">#执行 Docker 安装脚本,执行这个脚本会添加 docker.repo 源并安装 Docker。</span><br><span class="line">curl -fsSL https://get.docker.com/ | sh</span><br><span class="line"></span><br><span class="line">#启动 Docker 进程</span><br><span class="line">sudo service docker start</span><br><span class="line"></span><br><span class="line">#验证 docker 是否安装成功并在容器中执行一个测试的镜像</span><br><span class="line">sudo docker run hello-world</span><br></pre></td></tr></table></figure>
<h4 id="3、查看Docker版本"><a href="#3、查看Docker版本" class="headerlink" title="3、查看Docker版本"></a>3、查看Docker版本</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker version</span><br></pre></td></tr></table></figure>
<h4 id="4、设置开机自启动"><a href="#4、设置开机自启动" class="headerlink" title="4、设置开机自启动"></a>4、设置开机自启动</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl enable docker</span><br></pre></td></tr></table></figure>
<h4 id="5、Docker中安装redis"><a href="#5、Docker中安装redis" class="headerlink" title="5、Docker中安装redis"></a>5、Docker中安装redis</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#该方式默认下载的最新版本，如需要下载指定版本在redis后面跟:版本号</span><br><span class="line">docker pull redis</span><br></pre></td></tr></table></figure>
<h4 id="6、查看当前下载的redis镜像"><a href="#6、查看当前下载的redis镜像" class="headerlink" title="6、查看当前下载的redis镜像"></a>6、查看当前下载的redis镜像</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure>
<h4 id="7、启动Docker-Redis镜像"><a href="#7、启动Docker-Redis镜像" class="headerlink" title="7、启动Docker Redis镜像"></a>7、启动Docker Redis镜像</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># -p 主机端口：容器端口      -v 主机目录：容器目录</span><br><span class="line">docker run -it -p hostPort:containerPort -v hostDir:containerDir</span><br></pre></td></tr></table></figure>
<h4 id="8、挂载外部配置和数据安装"><a href="#8、挂载外部配置和数据安装" class="headerlink" title="8、挂载外部配置和数据安装"></a>8、挂载外部配置和数据安装</h4><p>1.创建目录和配置文件redis.conf</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#创建配置目录</span><br><span class="line">mkdir -p /home/docker/redis/conf</span><br><span class="line">#创建数据目录</span><br><span class="line">mkdir -p /home/docker/redis/data</span><br><span class="line">#创建redis配置文件</span><br><span class="line">touch /home/docker/redis/conf/redis.conf</span><br><span class="line">------------------------------redis.conf-----content---------------------------------</span><br><span class="line">#守护进程</span><br><span class="line">daemonize no</span><br><span class="line">#注释绑定本地IP</span><br><span class="line">bind 127.0.0.1</span><br><span class="line">#关闭保护模式</span><br><span class="line">protected-mode no</span><br><span class="line">#设置口令</span><br><span class="line">requirepass 123456</span><br><span class="line">------------------------------redis.conf-----content---------------------------------</span><br><span class="line"></span><br><span class="line">#启动容器</span><br><span class="line">docker run -it -d --privileged=true -p 6379:6379 -v /home/docker/redis/conf/redis.conf:/etc/redis/redis.conf -v /home/docker/redis/data:/data --name redis-4.0 redis:4.0 redis-server /etc/redis/redis.conf --appendonly yes</span><br><span class="line">#参数说明</span><br><span class="line">-d: 后台运行容器，并返回容器ID</span><br><span class="line">-i: 以交互模式运行容器，通常与 -t 同时使用</span><br><span class="line">-t: 为容器重新分配一个伪输入终端，通常与 -i 同时使用</span><br><span class="line">--privileged=true：容器内的root拥有真正root权限，否则容器内root只是外部普通用户权限</span><br><span class="line">-v /home/docker/redis/conf/redis.conf:/etc/redis/redis.conf：映射配置文件</span><br><span class="line">-v /home/docker/redis/data:/data：映射数据目录</span><br><span class="line">redis-server /etc/redis/redis.conf：指定配置文件启动redis-server进程</span><br><span class="line">--name : 指定容器名称，这个最好加上，不然看docker进程的时候会很尴尬</span><br><span class="line">--appendonly yes：开启数据持久化</span><br></pre></td></tr></table></figure>
<h4 id="9、Docker命令批量删除状态为Exited的容器"><a href="#9、Docker命令批量删除状态为Exited的容器" class="headerlink" title="9、Docker命令批量删除状态为Exited的容器"></a>9、Docker命令批量删除状态为Exited的容器</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm $(docker ps -q -f status=exited)</span><br></pre></td></tr></table></figure>
<h4 id="10、连接redis客户端实例"><a href="#10、连接redis客户端实例" class="headerlink" title="10、连接redis客户端实例"></a>10、连接redis客户端实例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@izbp13xko46hud9vfr5s94z ~]# docker exec -it 0d622f7cd0a4 redis-cli</span><br><span class="line">127.0.0.1:6379&gt;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

	<div>
      
	</div>

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div>
    
 </div>
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.ouscan.com/MyBatis/MyBatis-Plus的代码生成器AutoGenerator/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jaune lau">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="再回首">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/MyBatis/MyBatis-Plus的代码生成器AutoGenerator/" class="post-title-link" itemprop="url">MyBatis-Plus的代码生成器AutoGenerator</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-04-18 15:35:17 / Modified: 16:02:32" itemprop="dateCreated datePublished" datetime="2019-04-18T15:35:17+08:00">2019-04-18</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/MyBatis/" itemprop="url" rel="index"><span itemprop="name">MyBatis</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="代码生成器"><a href="#代码生成器" class="headerlink" title="代码生成器"></a>代码生成器</h3><p><strong>AutoGenerator 是 MyBatis-Plus 的代码生成器，通过 AutoGenerator 可以快速生成 Entity、Mapper、Mapper XML、Service、Controller 等各个模块的代码，极大的提升了开发效率。</strong></p>
<h4 id="添加依赖"><a href="#添加依赖" class="headerlink" title="添加依赖"></a>添加依赖</h4><p>MyBatis-Plus 从 <code>3.0.3</code> 之后移除了代码生成器与模板引擎的默认依赖，需要手动添加相关依赖：</p>
<ul>
<li><p>添加 代码生成器 依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-generator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>添加 模板引擎 依赖，MyBatis-Plus 支持 Velocity（默认）、Freemarker、Beetl，用户可以选择自己熟悉的模板引擎，如果都不满足您的要求，可以采用自定义模板引擎。</p>
<p>Velocity（默认）：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.velocity<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>velocity-engine-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Freemarker：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.freemarker<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>freemarker<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.28<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Beetl：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.ibeetl<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>beetl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * mysql 代码生成器演示例子</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> lau</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2019-04-12</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MysqlGenerator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 读取控制台内容</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">scanner</span><span class="params">(String tip)</span> </span>&#123;</span><br><span class="line">        Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        StringBuilder help = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        help.append(<span class="string">"请输入"</span> + tip + <span class="string">"："</span>);</span><br><span class="line">        System.out.println(help.toString());</span><br><span class="line">        <span class="keyword">if</span> (scanner.hasNext()) &#123;</span><br><span class="line">            String ipt = scanner.next();</span><br><span class="line">            <span class="keyword">if</span> (StringUtils.isNotEmpty(ipt)) &#123;</span><br><span class="line">                <span class="keyword">return</span> ipt;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> MybatisPlusException(<span class="string">"请输入正确的"</span> + tip + <span class="string">"！"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * RUN THIS</span></span><br><span class="line"><span class="comment">     * 执行 main 方法控制台输入模块表名回车自动生成对应项目目录中</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 代码生成器</span></span><br><span class="line">        AutoGenerator mpg = <span class="keyword">new</span> AutoGenerator();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 全局配置</span></span><br><span class="line">        GlobalConfig gc = <span class="keyword">new</span> GlobalConfig();</span><br><span class="line">        String projectPath = System.getProperty(<span class="string">"user.dir"</span>);</span><br><span class="line">        gc.setOutputDir(projectPath + <span class="string">"/mybatis-plus-sample-generator/src/main/java"</span>);</span><br><span class="line">        gc.setAuthor(<span class="string">"lau"</span>);</span><br><span class="line">        gc.setOpen(<span class="keyword">false</span>);</span><br><span class="line">        mpg.setGlobalConfig(gc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 数据源配置</span></span><br><span class="line">        DataSourceConfig dsc = <span class="keyword">new</span> DataSourceConfig();</span><br><span class="line">        dsc.setUrl(<span class="string">"jdbc:mysql://localhost:3306/test?serverTimezone=GMT%2B8&amp;useUnicode=true&amp;useSSL=false&amp;characterEncoding=utf8"</span>);</span><br><span class="line">        <span class="comment">// dsc.setSchemaName("public");</span></span><br><span class="line">        dsc.setDriverName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line">        dsc.setUsername(<span class="string">"root"</span>);</span><br><span class="line">        dsc.setPassword(<span class="string">"password"</span>);</span><br><span class="line">        mpg.setDataSource(dsc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 包配置</span></span><br><span class="line">        PackageConfig pc = <span class="keyword">new</span> PackageConfig();</span><br><span class="line">        pc.setModuleName(scanner(<span class="string">"模块名"</span>));</span><br><span class="line">        pc.setParent(<span class="string">"com.ouscan.mybatisplus.samples.generator"</span>);</span><br><span class="line">        mpg.setPackageInfo(pc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 自定义配置</span></span><br><span class="line">        InjectionConfig cfg = <span class="keyword">new</span> InjectionConfig() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="comment">// to do nothing</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        List&lt;FileOutConfig&gt; focList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        focList.add(<span class="keyword">new</span> FileOutConfig(<span class="string">"/templates/mapper.xml.ftl"</span>) &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">outputFile</span><span class="params">(TableInfo tableInfo)</span> </span>&#123;</span><br><span class="line">                <span class="comment">// 自定义输入文件名称</span></span><br><span class="line">                <span class="keyword">return</span> projectPath + <span class="string">"/mybatis-plus-sample-generator/src/main/resources/mapper/"</span> + pc.getModuleName()</span><br><span class="line">                        + <span class="string">"/"</span> + tableInfo.getEntityName() + <span class="string">"Mapper"</span> + StringPool.DOT_XML;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        cfg.setFileOutConfigList(focList);</span><br><span class="line">        mpg.setCfg(cfg);</span><br><span class="line">        mpg.setTemplate(<span class="keyword">new</span> TemplateConfig().setXml(<span class="keyword">null</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 策略配置</span></span><br><span class="line">        StrategyConfig strategy = <span class="keyword">new</span> StrategyConfig();</span><br><span class="line">        strategy.setNaming(NamingStrategy.underline_to_camel);</span><br><span class="line">        strategy.setColumnNaming(NamingStrategy.underline_to_camel);</span><br><span class="line">        <span class="comment">//strategy.setSuperEntityClass("com.ouscan.mybatisplus.samples.generator.common.BaseEntity");</span></span><br><span class="line">        strategy.setEntityLombokModel(<span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">//strategy.setSuperControllerClass("com.ouscan.mybatisplus.samples.generator.common.BaseController");</span></span><br><span class="line">        strategy.setInclude(scanner(<span class="string">"表名"</span>));</span><br><span class="line">        <span class="comment">//strategy.setSuperEntityColumns("id");</span></span><br><span class="line">        strategy.setControllerMappingHyphenStyle(<span class="keyword">true</span>);</span><br><span class="line">        strategy.setTablePrefix(pc.getModuleName() + <span class="string">"_"</span>);</span><br><span class="line">        mpg.setStrategy(strategy);</span><br><span class="line">        <span class="comment">// 选择 freemarker 引擎需要指定如下加，注意 pom 依赖必须有！</span></span><br><span class="line">        mpg.setTemplateEngine(<span class="keyword">new</span> FreemarkerTemplateEngine());</span><br><span class="line">        mpg.execute();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>注意！如果您选择了非默认引擎，需要在 AutoGenerator 中 设置模板引擎。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">AutoGenerator generator = <span class="keyword">new</span> AutoGenerator();</span><br><span class="line"></span><br><span class="line"><span class="comment">// set freemarker engine</span></span><br><span class="line">generator.setTemplateEngine(<span class="keyword">new</span> FreemarkerTemplateEngine());</span><br><span class="line"></span><br><span class="line"><span class="comment">// set beetl engine</span></span><br><span class="line">generator.setTemplateEngine(<span class="keyword">new</span> BeetlTemplateEngine());</span><br><span class="line"></span><br><span class="line"><span class="comment">// set custom engine (reference class is your custom engine class)</span></span><br><span class="line">generator.setTemplateEngine(<span class="keyword">new</span> CustomTemplateEngine());</span><br><span class="line"></span><br><span class="line"><span class="comment">// other config</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h4 id="编写配置"><a href="#编写配置" class="headerlink" title="编写配置"></a>编写配置</h4><p>MyBatis-Plus 的代码生成器提供了大量的自定义参数供用户选择，能够满足绝大部分人的使用需求。</p>
<ul>
<li><p>配置 GlobalConfig</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GlobalConfig globalConfig = <span class="keyword">new</span> GlobalConfig();</span><br><span class="line">globalConfig.setOutputDir(System.getProperty(<span class="string">"user.dir"</span>) + <span class="string">"/src/main/java"</span>);</span><br><span class="line">globalConfig.setAuthor(<span class="string">"lau"</span>);</span><br><span class="line">globalConfig.setOpen(<span class="keyword">false</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置 DataSourceConfig</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">DataSourceConfig dsc = <span class="keyword">new</span> DataSourceConfig();</span><br><span class="line">        dsc.setUrl(<span class="string">"jdbc:mysql://localhost:3306/test?serverTimezone=GMT%2B8&amp;useUnicode=true&amp;useSSL=false&amp;characterEncoding=utf8"</span>);</span><br><span class="line">        <span class="comment">// dsc.setSchemaName("public");</span></span><br><span class="line">        dsc.setDriverName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line">        dsc.setUsername(<span class="string">"root"</span>);</span><br><span class="line">        dsc.setPassword(<span class="string">"password"</span>);</span><br></pre></td></tr></table></figure>
<h4 id="自定义模板引擎"><a href="#自定义模板引擎" class="headerlink" title="自定义模板引擎"></a>自定义模板引擎</h4><p>请继承类 com.baomidou.mybatisplus.generator.engine.AbstractTemplateEngine</p>
<h4 id="自定义代码模板"><a href="#自定义代码模板" class="headerlink" title="自定义代码模板"></a>自定义代码模板</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/指定自定义模板路径, 位置：/resources/templates/entity2.java.ftl(或者是.vm)</span><br><span class="line"><span class="comment">//注意不要带上.ftl(或者是.vm), 会根据使用的模板引擎自动识别</span></span><br><span class="line">TemplateConfig templateConfig = <span class="keyword">new</span> TemplateConfig()</span><br><span class="line">    .setEntity(<span class="string">"templates/entity2.java"</span>);</span><br><span class="line"></span><br><span class="line">AutoGenerator mpg = <span class="keyword">new</span> AutoGenerator();</span><br><span class="line"><span class="comment">//配置自定义模板</span></span><br><span class="line">mpg.setTemplate(templateConfig);</span><br></pre></td></tr></table></figure>
<h4 id="自定义属性注入"><a href="#自定义属性注入" class="headerlink" title="自定义属性注入"></a>自定义属性注入</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">InjectionConfig injectionConfig = <span class="keyword">new</span> InjectionConfig() &#123;</span><br><span class="line">    <span class="comment">//自定义属性注入:abc</span></span><br><span class="line">    <span class="comment">//在.ftl(或者是.vm)模板中，通过$&#123;cfg.abc&#125;获取属性</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">"abc"</span>, <span class="keyword">this</span>.getConfig().getGlobalConfig().getAuthor() + <span class="string">"-mp"</span>);</span><br><span class="line">        <span class="keyword">this</span>.setMap(map);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">AutoGenerator mpg = <span class="keyword">new</span> AutoGenerator();</span><br><span class="line"><span class="comment">//配置自定义属性注入</span></span><br><span class="line">mpg.setCfg(injectionConfig);</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">entity2.java.ftl</span><br><span class="line">自定义属性注入abc=$&#123;cfg.abc&#125;</span><br><span class="line"></span><br><span class="line">entity2.java.vm</span><br><span class="line">自定义属性注入abc=$!&#123;cfg.abc&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h4><p><a href="https://mp.baomidou.com/" target="_blank" rel="noopener">MyBatis-Plus指南</a>为简化开发而生</p>

          
        
      
    </div>

    

    
    
    

	<div>
      
	</div>

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div>
    
 </div>
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.ouscan.com/study/learning-materials/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jaune lau">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="再回首">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/study/learning-materials/" class="post-title-link" itemprop="url">learning materials</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-04-17 16:41:52" itemprop="dateCreated datePublished" datetime="2019-04-17T16:41:52+08:00">2019-04-17</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-04-23 16:40:24" itemprop="dateModified" datetime="2019-04-23T16:40:24+08:00">2019-04-23</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/study/" itemprop="url" rel="index"><span itemprop="name">study</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://blog.csdn.net/q547550831?viewmode=contents" target="_blank" rel="noopener">博客</a><br><a href="http://www.runoob.com/" target="_blank" rel="noopener">菜鸟教程</a></p>
<p><a href="http://www.w3school.com.cn/" target="_blank" rel="noopener">w3school在线教程</a><br><a href="http://www.css88.com/" target="_blank" rel="noopener">web前端开发</a><br><a href="http://wiki.jikexueyuan.com/project/intellij-idea-tutorial/vcs-introduce.html" target="_blank" rel="noopener">ideal相关使用教程</a><br><a href="http://www.htmleaf.com/html5/html5youxi/" target="_blank" rel="noopener">jQuery之家</a></p>
<p><a href="https://www.ibm.com/developerworks/cn/" target="_blank" rel="noopener">developerworks</a></p>
<p><a href="https://www.ibm.com/developerworks/cn/java/j-top-java-content-2017/index.html" target="_blank" rel="noopener">developerWorks 上最受欢迎的 Java 内容</a></p>
<p><a href="https://cloud.tencent.com/solution/la?fromSource=gwzcw.891969.891969.891969" target="_blank" rel="noopener">小程序</a></p>
<p><a href="https://try.github.io/levels/1/challenges/1" target="_blank" rel="noopener">git基本操作</a></p>
<p><a href="http://learngitbranching.js.org/" target="_blank" rel="noopener">git进阶分支操作</a>-看不懂，右下角 切 英文</p>
<p><a href="https://leohxj.gitbooks.io/front-end-database/content/" target="_blank" rel="noopener">前端工程师手册</a></p>
<p><a href="https://qbgbook.gitbooks.io/spring-boot-reference-guide-zh/content/" target="_blank" rel="noopener">spring boot参考指南</a></p>
<p>requirejs<br>backbone<br>jdf<br>mock server<br>node.js<br>Lua<br>vue.js<br>bootstrap</p>
<p><a href="https://linesh.gitbooks.io/spring-mvc-documentation-linesh-translation/content/" target="_blank" rel="noopener">Spring MVC 4.2.4.RELEASE 中文文档</a></p>
<p><a href="https://dongchuan.gitbooks.io/java-interview-question/content/" target="_blank" rel="noopener">Java 面试笔记</a><br><a href="https://gnuhpc.gitbooks.io/redis-all-about/content/Intro/" target="_blank" rel="noopener">Redis开发运维实践指南</a></p>
<p><a href="https://gitee.com/renrenio/renren-security" target="_blank" rel="noopener">项目框架</a></p>
<p><a href="https://blog.csdn.net/winter_chen001/article/details/77249029" target="_blank" rel="noopener">Spring boot Mybatis 整合（完整版）</a></p>
<p><a href="https://www.bysocket.com/?author=1&amp;paged=2" target="_blank" rel="noopener">优秀的Spring Boot 文章（泥瓦匠BYSocket）</a></p>
<p><a href="https://github.com/JeffLi1993/springboot-learning-example" target="_blank" rel="noopener">实例（githup）</a></p>
<p><a href="https://blog.csdn.net/qq_32327073/article/details/78698580" target="_blank" rel="noopener">windows7环境下安装Linux（ubuntu64）虚拟机教程</a></p>
<p><a href="https://github.com/wuyouzhuguli/SpringAll" target="_blank" rel="noopener">SpringALL</a>  java spring相关资料</p>

          
        
      
    </div>

    

    
    
    

	<div>
      
	</div>

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div>
    
 </div>
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.ouscan.com/Java/json/Json转化为Java对象（object，List等）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jaune lau">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="再回首">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/Java/json/Json转化为Java对象（object，List等）/" class="post-title-link" itemprop="url">Json转化为Java对象（object，List等）</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-04-17 16:25:03 / Modified: 16:26:06" itemprop="dateCreated datePublished" datetime="2019-04-17T16:25:03+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/json/" itemprop="url" rel="index"><span itemprop="name">json</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>问题：前后端数据交互时，经常会遇到Json串与Java对象转化的问题，有的Java对象中还包含了List对象等。</p>
<p>解决方案： </p>
<ol>
<li>引入 json-lib包，Maven坐标如下：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;net.sf.json-lib&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;json-lib&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;2.4&lt;/version&gt;</span><br><span class="line">            &lt;classifier&gt;jdk15&lt;/classifier&gt;</span><br><span class="line">&lt;/dependency&gt;123456</span><br></pre></td></tr></table></figure>
<ol>
<li>Json串转化为List对象:</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">JSONArray jsonArray = JSONArray.fromObject(jsonString);</span><br><span class="line"></span><br><span class="line">List&lt;Config&gt; list = (List) JSONArray.toCollection(jsonArray,</span><br><span class="line">                    Class.class);1234</span><br></pre></td></tr></table></figure>
<ol>
<li>Json串转化为Object对象</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">JSONObject jsonObject = JSONObject.fromObject(jsonString);</span><br><span class="line">Object object = (Object) JSONObject.toBean(jsonObject, Object.class);12</span><br></pre></td></tr></table></figure>
<ol>
<li>Json串转化为包含List对象的Object对象</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">JSONObject jsonObject = JSONObject.fromObject(jsonString);</span><br><span class="line"></span><br><span class="line">Map&lt;String, Class&gt; listMap = new HashMap&lt;String, Class&gt;();</span><br><span class="line">listMap.put(&quot;list&quot;, listObject.class);</span><br><span class="line"></span><br><span class="line">Object object = (Object) JSONObject.toBean(jsonObject, Object.class, listMap);</span><br><span class="line">1234567</span><br></pre></td></tr></table></figure>
<p>PS：Object对象中可能包含了多个对象，对象中可能又包含了多个List对象互相嵌套。<br>只需要把所有的List对象值组装成Map对象即可，对应的key为List对象的属性名称。</p>

          
        
      
    </div>

    

    
    
    

	<div>
      
	</div>

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div>
    
 </div>
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.ouscan.com/Java/fastJson/fastJson过滤字段-深层次/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jaune lau">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="再回首">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/Java/fastJson/fastJson过滤字段-深层次/" class="post-title-link" itemprop="url">fastJson过滤字段(深层次)</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-04-17 16:20:07 / Modified: 16:22:25" itemprop="dateCreated datePublished" datetime="2019-04-17T16:20:07+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/fastJson/" itemprop="url" rel="index"><span itemprop="name">fastJson</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>前言:前后端分离,一般都是返回JSON数据,但是有时候需要返回指定的属性,那么就有如下几种方式:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">* 第一种：在对象响应字段前加注解，这样生成的json也不包含该字段。</span><br><span class="line">* @JSONField(serialize=false)</span><br><span class="line">* private String name;</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">* 第二种：在对象对应字段前面加transient，表示该字段不用序列化，即在生成json的时候就不会包含该字段了。</span><br><span class="line">* private transient String name;</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">* 第三种：使用fastjson的拦截器</span><br><span class="line">* PropertyFilter profilter = new PropertyFilter()&#123;</span><br><span class="line">@Override</span><br><span class="line">public boolean apply(Object object, String name, Object value) &#123;</span><br><span class="line">if(name.equalsIgnoreCase(&quot;last&quot;))&#123;</span><br><span class="line">//false表示last字段将被排除在外</span><br><span class="line">return false;</span><br><span class="line">&#125;</span><br><span class="line">return true;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line">json = JSON.toJSONString(user, profilter);</span><br><span class="line">System.out.println(json);</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">* 第四种，直接填写属性(就是你需要什么属性,你就用什么属性)</span><br><span class="line">* SimplePropertyPreFilter filter = new SimplePropertyPreFilter(TTown.class, &quot;id&quot;,&quot;townname&quot;);</span><br><span class="line">response.getWriter().write(JSONObject.toJSONString(townList,filter));</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//第五种:深层次过滤</span><br><span class="line">//TTown1对象中有属性名称为TTown2对象,只需要TTown1的id属性包括TTown2对象的id属性</span><br><span class="line">SimplePropertyPreFilter filter1 = new SimplePropertyPreFilter(TTown1.class, &quot;id&quot;,&quot;townname&quot;);</span><br><span class="line">SimplePropertyPreFilter filter2 = new SimplePropertyPreFilter(TTown2.class, &quot;id&quot;,&quot;townname&quot;);</span><br><span class="line">SerializeFilter[] filters=new SerializeFilter[]&#123;filter1,filter2&#125;;</span><br><span class="line">System.out.println(JSONObject.toJSONString(result, filters));</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    

    
    
    

	<div>
      
	</div>

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div>
    
 </div>
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.ouscan.com/Java/Spring-Boot/Ehcache/Spring-Boot整合Ehcache实现缓存功能/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jaune lau">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="再回首">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/Java/Spring-Boot/Ehcache/Spring-Boot整合Ehcache实现缓存功能/" class="post-title-link" itemprop="url">Spring Boot整合Ehcache实现缓存功能</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-04-17 16:14:03 / Modified: 16:17:37" itemprop="dateCreated datePublished" datetime="2019-04-17T16:14:03+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/Spring-Boot/" itemprop="url" rel="index"><span itemprop="name">Spring Boot</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/Spring-Boot/Ehcache/" itemprop="url" rel="index"><span itemprop="name">Ehcache</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这里介绍Spring Boot结合JPA，MySQL和Ehcache实现缓存功能，提高程序访问效率。</p>
<h3 id="一、Maven依赖"><a href="#一、Maven依赖" class="headerlink" title="一、Maven依赖"></a>一、Maven依赖</h3><p>主要依赖如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;</span><br><span class="line">         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;</span><br><span class="line">    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</span><br><span class="line"></span><br><span class="line">    &lt;groupId&gt;springboot.example&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;springboot-ehcache&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;</span><br><span class="line">    &lt;packaging&gt;jar&lt;/packaging&gt;</span><br><span class="line">    &lt;description&gt;Spring Boot整合EhCache实现缓存功能&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">    &lt;parent&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;1.5.8.RELEASE&lt;/version&gt;</span><br><span class="line">        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;</span><br><span class="line">    &lt;/parent&gt;</span><br><span class="line"></span><br><span class="line">    &lt;properties&gt;</span><br><span class="line">        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;</span><br><span class="line">        &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;</span><br><span class="line">        &lt;java.version&gt;1.8&lt;/java.version&gt;</span><br><span class="line">    &lt;/properties&gt;</span><br><span class="line"></span><br><span class="line">    &lt;dependencies&gt;</span><br><span class="line"></span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;</span><br><span class="line">            &lt;scope&gt;runtime&lt;/scope&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</span><br><span class="line">            &lt;scope&gt;test&lt;/scope&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- caching --&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-cache&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;net.sf.ehcache&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;ehcache&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- 数据库依赖 --&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class="line">            &lt;scope&gt;runtime&lt;/scope&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/dependencies&gt;</span><br><span class="line"></span><br><span class="line">    &lt;build&gt;</span><br><span class="line">        &lt;plugins&gt;</span><br><span class="line">            &lt;plugin&gt;</span><br><span class="line">                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">            &lt;/plugin&gt;</span><br><span class="line">        &lt;/plugins&gt;</span><br><span class="line">    &lt;/build&gt;</span><br><span class="line"></span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure>
<p>上面的依赖中包括了Spring Boot的核心依赖，Ehcache依赖还有数据库JPA和MySQL的依赖。</p>
<h3 id="二、程序的主要代码实现"><a href="#二、程序的主要代码实现" class="headerlink" title="二、程序的主要代码实现"></a>二、程序的主要代码实现</h3><p>1、Spring Boot程序的入口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">package com.lemon.springboot.application;</span><br><span class="line"></span><br><span class="line">import org.springframework.boot.SpringApplication;</span><br><span class="line">import org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line">import org.springframework.cache.annotation.EnableCaching;</span><br><span class="line">import org.springframework.context.annotation.ComponentScan;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author lemon</span><br><span class="line"> */</span><br><span class="line">@SpringBootApplication</span><br><span class="line">@ComponentScan(&#123;&quot;com.lemon.springboot&quot;&#125;)</span><br><span class="line">// 启用缓存注解</span><br><span class="line">@EnableCaching</span><br><span class="line">public class MainApplication &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        SpringApplication.run(MainApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的三个注解：<br> 1）@SpringBootApplication表明是一个Spring Boot应用；<br> 2）@ComponentScan({“com.lemon.springboot”})扫描指定包内的注解；<br> 3）@EnableCaching启动缓存注解（也就是说使项目内部的缓存相关的注解生效）</p>
<p>2、application.yml和ehcache.xml配置文件<br> 配置文件中关于数据库配置这一块仅仅配置了开发模式，生产模式和特使模式没有配置。所以启用的也是开发者模式。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  profiles:</span><br><span class="line">    active: dev</span><br><span class="line">  # 缓存配置</span><br><span class="line">  cache:</span><br><span class="line">    type: ehcache</span><br><span class="line">    ehcache:</span><br><span class="line">      config: classpath:ehcache.xml</span><br><span class="line"></span><br><span class="line"># 日志配置</span><br><span class="line">logging:</span><br><span class="line">  file: /Users/lemon/IdeaProjects/springboot/lemon.log</span><br><span class="line">  level: info</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">spring:</span><br><span class="line">  profiles: dev</span><br><span class="line">  # 数据库配置</span><br><span class="line">  datasource:</span><br><span class="line">      driverClassName: com.mysql.jdbc.Driver</span><br><span class="line">      url: jdbc:mysql://192.168.25.11:3306/ehcachetest?characterEncoding=utf8</span><br><span class="line">      username: root</span><br><span class="line">      password: 123456</span><br><span class="line">  jpa:</span><br><span class="line">    database: MYSQL</span><br><span class="line">    show-sql: true</span><br><span class="line">    hibernate:</span><br><span class="line">      ddl-auto: update</span><br><span class="line">      naming_strategy: org.hibernate.cfg.ImprovedNamingStrategy</span><br><span class="line">      use_sql_comments: false</span><br><span class="line">      format_sql: true</span><br><span class="line">      hbm2ddl_auto: update</span><br><span class="line">      generate_statistics: false</span><br><span class="line">      validation_mode: none</span><br><span class="line">      store_data_at_delete: true</span><br><span class="line">      global_with_modified_flag: true</span><br><span class="line">    properties:</span><br><span class="line">      hibernate:</span><br><span class="line">        dialect: org.hibernate.dialect.MySQL5Dialect</span><br><span class="line">server:</span><br><span class="line">  port: 8080</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">spring:</span><br><span class="line">  profiles: pro</span><br><span class="line">server:</span><br><span class="line">  port: 8081</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">spring:</span><br><span class="line">  profiles: test</span><br><span class="line">server:</span><br><span class="line">  port: 8082</span><br></pre></td></tr></table></figure>
<p>ehcache.xml配置文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;ehcache xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">         xsi:noNamespaceSchemaLocation=&quot;http://ehcache.org/ehcache.xsd&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;cache name=&quot;lemonCache&quot;</span><br><span class="line">           eternal=&quot;false&quot;</span><br><span class="line">           maxEntriesLocalHeap=&quot;0&quot;</span><br><span class="line">           timeToIdleSeconds=&quot;200&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- eternal：true表示对象永不过期，此时会忽略timeToIdleSeconds和timeToLiveSeconds属性，默认为false --&gt;</span><br><span class="line">    &lt;!-- maxEntriesLocalHeap：堆内存中最大缓存对象数，0没有限制 --&gt;</span><br><span class="line">    &lt;!-- timeToIdleSeconds： 设定允许对象处于空闲状态的最长时间，以秒为单位。当对象自从最近一次被访问后，</span><br><span class="line">    如果处于空闲状态的时间超过了timeToIdleSeconds属性值，这个对象就会过期，EHCache将把它从缓存中清空。</span><br><span class="line">    只有当eternal属性为false，该属性才有效。如果该属性值为0，则表示对象可以无限期地处于空闲状态 --&gt;</span><br><span class="line">&lt;/ehcache&gt;</span><br></pre></td></tr></table></figure>
<p>3、实体类<br> 这里新建一个实体类，用来创造对象存入数据库和缓存。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">package com.lemon.springboot.domain;</span><br><span class="line"></span><br><span class="line">import javax.persistence.*;</span><br><span class="line">import java.util.Date;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author lemon</span><br><span class="line"> */</span><br><span class="line">@Entity</span><br><span class="line">@Table(name = &quot;user&quot;)</span><br><span class="line">public class User &#123;</span><br><span class="line"></span><br><span class="line">    @Id</span><br><span class="line">    @GeneratedValue</span><br><span class="line">    private Integer id;</span><br><span class="line">    @Column</span><br><span class="line">    private String name;</span><br><span class="line">    @Column</span><br><span class="line">    private Integer age;</span><br><span class="line">    @Column</span><br><span class="line">    private String address;</span><br><span class="line">    @Column</span><br><span class="line">    private Date createTime;</span><br><span class="line"></span><br><span class="line">    public Date getCreateTime() &#123;</span><br><span class="line">        return createTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setCreateTime(Date createTime) &#123;</span><br><span class="line">        this.createTime = createTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Integer getId() &#123;</span><br><span class="line">        return id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setId(Integer id) &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setName(String name) &#123;</span><br><span class="line">        this.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Integer getAge() &#123;</span><br><span class="line">        return age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setAge(Integer age) &#123;</span><br><span class="line">        this.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getAddress() &#123;</span><br><span class="line">        return address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setAddress(String address) &#123;</span><br><span class="line">        this.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;User&#123;&quot; +</span><br><span class="line">                &quot;id=&quot; + id +</span><br><span class="line">                &quot;, name=&apos;&quot; + name + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, age=&quot; + age +</span><br><span class="line">                &quot;, address=&apos;&quot; + address + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, createTime=&quot; + createTime +</span><br><span class="line">                &apos;&#125;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4、与数据库交互的Repository<br> 创建一个与数据库交互的Repository，这个Repository只需要继承JpaRepository即可，对于简单的增删改查，就不需要额外扩展功能了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">package com.lemon.springboot.repository;</span><br><span class="line"></span><br><span class="line">import com.lemon.springboot.domain.User;</span><br><span class="line">import org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author lemon</span><br><span class="line"> */</span><br><span class="line">public interface UserRepository extends JpaRepository&lt;User, Integer&gt; &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对于Spring Boot应用，需要创建JPA的配置类：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">package com.lemon.springboot.configuration;</span><br><span class="line"></span><br><span class="line">import org.springframework.beans.factory.annotation.Value;</span><br><span class="line">import org.springframework.boot.autoconfigure.domain.EntityScan;</span><br><span class="line">import org.springframework.context.annotation.Bean;</span><br><span class="line">import org.springframework.context.annotation.Configuration;</span><br><span class="line">import org.springframework.core.Ordered;</span><br><span class="line">import org.springframework.core.annotation.Order;</span><br><span class="line">import org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor;</span><br><span class="line">import org.springframework.data.jpa.repository.config.EnableJpaRepositories;</span><br><span class="line">import org.springframework.jdbc.datasource.DriverManagerDataSource;</span><br><span class="line">import org.springframework.orm.jpa.JpaTransactionManager;</span><br><span class="line">import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;</span><br><span class="line">import org.springframework.orm.jpa.vendor.Database;</span><br><span class="line">import org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;</span><br><span class="line">import org.springframework.transaction.PlatformTransactionManager;</span><br><span class="line">import org.springframework.transaction.annotation.EnableTransactionManagement;</span><br><span class="line">import org.springframework.transaction.support.TransactionTemplate;</span><br><span class="line"></span><br><span class="line">import javax.sql.DataSource;</span><br><span class="line">import java.util.Properties;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * JPA配置类</span><br><span class="line"> *</span><br><span class="line"> * @author lemon</span><br><span class="line"> */</span><br><span class="line">@Order(Ordered.HIGHEST_PRECEDENCE)</span><br><span class="line">@Configuration</span><br><span class="line">@EnableTransactionManagement(proxyTargetClass = true)</span><br><span class="line">@EnableJpaRepositories(basePackages = &quot;com.lemon.springboot.repository&quot;)</span><br><span class="line">@EntityScan(basePackages = &quot;com.lemon.springboot.domain&quot;)</span><br><span class="line">public class JpaConfiguration &#123;</span><br><span class="line"></span><br><span class="line">    @Value(&quot;$&#123;spring.datasource.driverClassName&#125;&quot;)</span><br><span class="line">    private String driverClassName;</span><br><span class="line">    @Value(&quot;$&#123;spring.datasource.url&#125;&quot;)</span><br><span class="line">    private String url;</span><br><span class="line">    @Value(&quot;$&#123;spring.datasource.username&#125;&quot;)</span><br><span class="line">    private String username;</span><br><span class="line">    @Value(&quot;$&#123;spring.datasource.password&#125;&quot;)</span><br><span class="line">    private String password;</span><br><span class="line">    @Value(&quot;$&#123;spring.jpa.properties.hibernate.dialect&#125;&quot;)</span><br><span class="line">    private String dialect;</span><br><span class="line">    @Value(&quot;$&#123;spring.jpa.show-sql&#125;&quot;)</span><br><span class="line">    private String showSql;</span><br><span class="line">    @Value(&quot;$&#123;spring.jpa.hibernate.use_sql_comments&#125;&quot;)</span><br><span class="line">    private String useSqlComments;</span><br><span class="line">    @Value(&quot;$&#123;spring.jpa.hibernate.format_sql&#125;&quot;)</span><br><span class="line">    private String formatSql;</span><br><span class="line">    @Value(&quot;$&#123;spring.jpa.hibernate.hbm2ddl_auto&#125;&quot;)</span><br><span class="line">    private String hbm2ddlAuto;</span><br><span class="line">    @Value(&quot;$&#123;spring.jpa.hibernate.generate_statistics&#125;&quot;)</span><br><span class="line">    private String generateStatistics;</span><br><span class="line">    @Value(&quot;$&#123;spring.jpa.hibernate.validation_mode&#125;&quot;)</span><br><span class="line">    private String validationMode;</span><br><span class="line">    @Value(&quot;$&#123;spring.jpa.hibernate.store_data_at_delete&#125;&quot;)</span><br><span class="line">    private String storeDataAtDelete;</span><br><span class="line">    @Value(&quot;$&#123;spring.jpa.hibernate.global_with_modified_flag&#125;&quot;)</span><br><span class="line">    private String globalWithModifiedFlag;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    PersistenceExceptionTranslationPostProcessor persistenceExceptionTranslationPostProcessor() &#123;</span><br><span class="line">        return new PersistenceExceptionTranslationPostProcessor();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public DataSource dataSource() &#123;</span><br><span class="line">        DriverManagerDataSource dataSource = new DriverManagerDataSource();</span><br><span class="line">        dataSource.setDriverClassName(driverClassName);</span><br><span class="line">        dataSource.setUrl(url);</span><br><span class="line">        dataSource.setUsername(username);</span><br><span class="line">        dataSource.setPassword(password);</span><br><span class="line">        return dataSource;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public LocalContainerEntityManagerFactoryBean entityManagerFactory() &#123;</span><br><span class="line">        LocalContainerEntityManagerFactoryBean entityManagerFactoryBean = new LocalContainerEntityManagerFactoryBean();</span><br><span class="line">        entityManagerFactoryBean.setDataSource(dataSource());</span><br><span class="line">        entityManagerFactoryBean.setPackagesToScan(&quot;com.lemon.springboot.domain&quot;);</span><br><span class="line">        entityManagerFactoryBean.setJpaProperties(buildHibernateProperties());</span><br><span class="line">        entityManagerFactoryBean.setJpaVendorAdapter(new HibernateJpaVendorAdapter() &#123;&#123;</span><br><span class="line">            setDatabase(Database.MYSQL);</span><br><span class="line">        &#125;&#125;);</span><br><span class="line">        return entityManagerFactoryBean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    protected Properties buildHibernateProperties() &#123;</span><br><span class="line">        Properties hibernateProperties = new Properties();</span><br><span class="line">        hibernateProperties.setProperty(&quot;hibernate.dialect&quot;, dialect);</span><br><span class="line">        hibernateProperties.setProperty(&quot;hibernate.show_sql&quot;, showSql);</span><br><span class="line">        hibernateProperties.setProperty(&quot;hibernate.use_sql_comments&quot;, useSqlComments);</span><br><span class="line">        hibernateProperties.setProperty(&quot;hibernate.format_sql&quot;, formatSql);</span><br><span class="line">        hibernateProperties.setProperty(&quot;hibernate.hbm2ddl.auto&quot;, hbm2ddlAuto);</span><br><span class="line">        hibernateProperties.setProperty(&quot;hibernate.generate_statistics&quot;, generateStatistics);</span><br><span class="line">        hibernateProperties.setProperty(&quot;javax.persistence.validation.mode&quot;, validationMode);</span><br><span class="line"></span><br><span class="line">        //Audit History flags</span><br><span class="line">        hibernateProperties.setProperty(&quot;org.hibernate.envers.store_data_at_delete&quot;, storeDataAtDelete);</span><br><span class="line">        hibernateProperties.setProperty(&quot;org.hibernate.envers.global_with_modified_flag&quot;, globalWithModifiedFlag);</span><br><span class="line"></span><br><span class="line">        return hibernateProperties;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public PlatformTransactionManager transactionManager() &#123;</span><br><span class="line">        return new JpaTransactionManager();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public TransactionTemplate transactionTemplate() &#123;</span><br><span class="line">        return new TransactionTemplate(transactionManager());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>5、与缓存相关的代码<br> EhcacheRepository：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">package com.lemon.springboot.repository;</span><br><span class="line"></span><br><span class="line">import com.lemon.springboot.domain.User;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author lemon</span><br><span class="line"> */</span><br><span class="line">public interface EhcacheRepository &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 增加用户</span><br><span class="line">     * @param user 用户</span><br><span class="line">     * @return 增加后的用户</span><br><span class="line">     */</span><br><span class="line">    User save(User user);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 查询用户</span><br><span class="line">     * @param id 主键</span><br><span class="line">     * @return 用户</span><br><span class="line">     */</span><br><span class="line">    User selectById(Integer id);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 更新用户</span><br><span class="line">     * @param user 更新的用户</span><br><span class="line">     * @return 用户</span><br><span class="line">     */</span><br><span class="line">    User updateById(User user);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 删除用户</span><br><span class="line">     * @param id 主键</span><br><span class="line">     * @return 删除状态</span><br><span class="line">     */</span><br><span class="line">    String deleteById(Integer id);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>它的实现类：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">package com.lemon.springboot.repository.impl;</span><br><span class="line"></span><br><span class="line">import com.lemon.springboot.domain.User;</span><br><span class="line">import com.lemon.springboot.repository.EhcacheRepository;</span><br><span class="line">import com.lemon.springboot.repository.UserRepository;</span><br><span class="line">import org.slf4j.Logger;</span><br><span class="line">import org.slf4j.LoggerFactory;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.cache.annotation.CacheConfig;</span><br><span class="line">import org.springframework.cache.annotation.CacheEvict;</span><br><span class="line">import org.springframework.cache.annotation.CachePut;</span><br><span class="line">import org.springframework.cache.annotation.Cacheable;</span><br><span class="line">import org.springframework.stereotype.Repository;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author lemon</span><br><span class="line"> */</span><br><span class="line">// cacheNames为ehcache.xml配置文件内的配置名称</span><br><span class="line">@CacheConfig(cacheNames = &#123;&quot;lemonCache&quot;&#125;)</span><br><span class="line">@Repository</span><br><span class="line">public class EhcacheRepositoryImpl implements EhcacheRepository &#123;</span><br><span class="line"></span><br><span class="line">    private static final Logger logger = LoggerFactory.getLogger(EhcacheRepository.class);</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private UserRepository userRepository;</span><br><span class="line"></span><br><span class="line">    @CachePut(key = &quot;#p0&quot;)</span><br><span class="line">    @Override</span><br><span class="line">    public User save(User user) &#123;</span><br><span class="line">        User savedUser = userRepository.save(user);</span><br><span class="line">        logger.info(&quot;新增功能，同步到缓存，直接写入数据库，ID为：&quot; + savedUser.getId());</span><br><span class="line">        return savedUser;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Cacheable(key = &quot;#p0&quot;)</span><br><span class="line">    @Override</span><br><span class="line">    public User selectById(Integer id) &#123;</span><br><span class="line">        logger.info(&quot;查询功能，缓存未找到，直接读取数据库，ID为：&quot; + id);</span><br><span class="line">        return userRepository.findOne(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @CachePut(key = &quot;#p0&quot;)</span><br><span class="line">    @Override</span><br><span class="line">    public User updateById(User user) &#123;</span><br><span class="line">        logger.info(&quot;更新功能，更新缓存，直接更新数据库，ID为：&quot; + user.getId());</span><br><span class="line">        return userRepository.save(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @CacheEvict(key = &quot;#p0&quot;)</span><br><span class="line">    @Override</span><br><span class="line">    public String deleteById(Integer id) &#123;</span><br><span class="line">        logger.info(&quot;删除功能，删除缓存，直接删除数据库数据，ID为：&quot; + id);</span><br><span class="line">        userRepository.delete(id);</span><br><span class="line">        return &quot;删除成功&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意：<br> 1）@CacheConfig(cacheNames = {“lemonCache”})设置了ehcache的名称，这个名称就是ehcache.xml内的名称；<br> 2）@Cacheable：应用到读取数据的方法上，即可缓存的方法，如查找方法：先从缓存中读取，如果没有再调 用方法获取数据，然后把数据添加到缓存中，适用于查找；<br> 3）@CachePut：主要针对方法配置，能够根据方法的请求参数对其结果进行缓存，和 @Cacheable 不同的是，它每次都会触发真实方法的调用。适用于更新和插入；<br> 4）@CacheEvict：主要针对方法配置，能够根据一定的条件对缓存进行清空。适用于删除。</p>
<h3 id="三、测试的Controller"><a href="#三、测试的Controller" class="headerlink" title="三、测试的Controller"></a>三、测试的Controller</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">package com.lemon.springboot.controller;</span><br><span class="line"></span><br><span class="line">import com.lemon.springboot.domain.User;</span><br><span class="line">import com.lemon.springboot.repository.EhcacheRepository;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.stereotype.Controller;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line">import org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"></span><br><span class="line">import java.util.Date;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author lemon</span><br><span class="line"> */</span><br><span class="line">@Controller</span><br><span class="line">@RequestMapping(&quot;/ehcache&quot;)</span><br><span class="line">public class EhcacheController &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private EhcacheRepository ehcacheRepository;</span><br><span class="line"></span><br><span class="line">    @RequestMapping(&quot;/save&quot;)</span><br><span class="line">    @ResponseBody</span><br><span class="line">    public User save() &#123;</span><br><span class="line">        User user = new User();</span><br><span class="line">        user.setName(&quot;lemon&quot;);</span><br><span class="line">        user.setAge(20);</span><br><span class="line">        user.setAddress(&quot;Wuhan&quot;);</span><br><span class="line">        user.setCreateTime(new Date());</span><br><span class="line">        return ehcacheRepository.save(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @RequestMapping(&quot;/select&quot;)</span><br><span class="line">    @ResponseBody</span><br><span class="line">    public User get(@RequestParam(defaultValue = &quot;1&quot;) Integer id) &#123;</span><br><span class="line">        return ehcacheRepository.selectById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @RequestMapping(&quot;/update&quot;)</span><br><span class="line">    @ResponseBody</span><br><span class="line">    public User update(@RequestParam(defaultValue = &quot;1&quot;) Integer id) &#123;</span><br><span class="line">        User user = ehcacheRepository.selectById(id);</span><br><span class="line">        user.setName(&quot;TestName&quot;);</span><br><span class="line">        user.setCreateTime(new Date());</span><br><span class="line">        return ehcacheRepository.updateById(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @RequestMapping(&quot;/delete&quot;)</span><br><span class="line">    @ResponseBody</span><br><span class="line">    public String delete(@RequestParam(defaultValue = &quot;1&quot;) Integer id) &#123;</span><br><span class="line">        return ehcacheRepository.deleteById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>启动项目，打开浏览器，输入地址：<a href="https://link.jianshu.com?t=http://localhost:8080/ehcache/save" target="_blank" rel="noopener">http://localhost:8080/ehcache/save</a>就可以实现插入数据，再输入<a href="https://link.jianshu.com?t=http://localhost:8080/ehcache/select?id=1" target="_blank" rel="noopener">http://localhost:8080/ehcache/select?id=1</a>就可以查询到数据，这时候观察控制台或者日志就可以发现，查询的时候并没有去访问数据库，而是直接在缓存中查询了，至于更新和删除，道理是一样的。</p>

          
        
      
    </div>

    

    
    
    

	<div>
      
	</div>

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div>
    
 </div>
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.ouscan.com/前端/nvm/node/在windows下用nvm-安装node/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jaune lau">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="再回首">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/前端/nvm/node/在windows下用nvm-安装node/" class="post-title-link" itemprop="url">在windows下用nvm 安装node</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-04-17 14:51:45 / Modified: 15:20:02" itemprop="dateCreated datePublished" datetime="2019-04-17T14:51:45+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/前端/" itemprop="url" rel="index"><span itemprop="name">前端</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/前端/nvm/" itemprop="url" rel="index"><span itemprop="name">nvm</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/前端/nvm/node/" itemprop="url" rel="index"><span itemprop="name">node</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>注：现在node的新版本已默认安装了npm</p>
<h3 id="1-nvm-下载"><a href="#1-nvm-下载" class="headerlink" title="1.   nvm 下载"></a>1.   nvm 下载</h3><hr>
<p>nvm 的下载地址：<a href="https://github.com/coreybutler/nvm-windows/releases" target="_blank" rel="noopener">https://github.com/coreybutler/nvm-windows/releases</a> 。选择第一个 nvm-noinstall.zip ，然后解压在系统盘（一般开发相关的文件我都放C盘，但是放别的盘也是可以的）。我放的目录路径是C:\dev\nvm。解压出来的文件有：</p>
<ul>
<li><p>elevate.cmd</p>
</li>
<li><p>elevate.vbs</p>
</li>
<li><p>install.cmd</p>
</li>
<li><p>LICENSE</p>
</li>
<li><p>nvm.exe</p>
</li>
</ul>
<h3 id="2-nvm-安装"><a href="#2-nvm-安装" class="headerlink" title="2.   nvm 安装"></a>2.   nvm 安装</h3><hr>
<p>双击 <code>install.cmd</code> ，是以控制台形式显示的，第一下直接按回车，然后会在C盘根目录产生<code>settings.txt</code>，把这个文件放进刚刚解压的那个目录，然后修改<code>settings.txt</code>内容，改成下面那样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root: C:\dev\nvm</span><br><span class="line">path: C:\dev\nodejs </span><br><span class="line">arch: 64</span><br><span class="line">proxy: none </span><br><span class="line">node_mirror: http://npm.taobao.org/mirrors/node/</span><br><span class="line">npm_mirror: https://npm.taobao.org/mirrors/npm/</span><br></pre></td></tr></table></figure>
<p>但是有些人很不幸，这个方法行不通，因为打开 <code>install.cmd</code>按下回车后，显示拒绝访问注册表路径，并弹出一个settings.txt。这时候，你只要淡定地叉掉那个文本以及控制台，然后在刚刚的目录里新建一个文件<code>settings.txt</code>，最后把上面的内容复制进去就可以了。</p>
<ul>
<li>root ： nvm的存放地址</li>
<li>path ： 存放指向node版本的快捷方式，使用nvm的过程中会自动生成。一般写的时候与nvm同级。</li>
<li>arch  ： 电脑系统是64位就写64,32位就写32</li>
<li>proxy  ： 代理</li>
</ul>
<h3 id="3-nvm-配置"><a href="#3-nvm-配置" class="headerlink" title="3.   nvm 配置"></a>3.   nvm 配置</h3><hr>
<ul>
<li>以控制台方法执行成功的，在环境变量里会自动配置了 <strong>NVM_HOME</strong> 和 <strong>NVM_SYMLINK</strong> ，这时候只要修改相应的路径就行了。</li>
<li>直接创建settings文件的可以在环境变量里创建 <strong>NVM_HOME</strong> 和 <strong>NVM_SYMLINK</strong>，并添加路径<br> 要是嫌弃可视化界面打开环境变量的步骤太麻烦，可以直接使用  <strong> <code>windows+r =&gt; sysdm.cpl</code> </strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NVM_HOME： C:\dev\nvm</span><br><span class="line">NVM_SYMLINK ： C:\dev\nodejs</span><br></pre></td></tr></table></figure>
<ul>
<li>在<strong>PATH</strong>里加上<strong>;%NVM_HOME%;%NVM_SYMLINK%;</strong>。<br> 一键控制台install的还要检查 环境变量    <strong>PATH</strong>    上的路径有没有添加<code>C:\dev\nvm</code>以及<code>C:\dev\nodejs</code>,有的话就删掉。</li>
</ul>
<h3 id="4-检测安装结果"><a href="#4-检测安装结果" class="headerlink" title="4.  检测安装结果"></a>4.  检测安装结果</h3><hr>
<p>打开控制台，输入：<code>nvm -v</code>,若是出现版本信息，则安装。若报错，那就重新把步骤再捋一遍。</p>
<ul>
<li>检查环境变量是否配置成功：可以在控制台输入：<code>set [环境变量名]</code>，查看路径是否填写错误</li>
</ul>
<h3 id="5-使用node"><a href="#5-使用node" class="headerlink" title="5.   使用node"></a>5.   使用node</h3><hr>
<ul>
<li>控制台下载 =&gt; 输入：<code>nvm install [版本号]</code>，下载最新版的可以直接输<code>nvm install latest</code> </li>
<li>下载完成后，在控制台输入：<code>nvm use [版本号]</code>。即使用这个版本号的node了。在use后，上面所说的nodejs文件夹就自动生成了。（在use之前是没有的哦）</li>
</ul>

          
        
      
    </div>

    

    
    
    

	<div>
      
	</div>

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-categories" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div>
    
 </div>
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.ouscan.com/Java/Spring-Boot/Spring-Boot-二/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jaune lau">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="再回首">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/Java/Spring-Boot/Spring-Boot-二/" class="post-title-link" itemprop="url">Spring Boot 二</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-04-17 14:36:55 / Modified: 15:18:56" itemprop="dateCreated datePublished" datetime="2019-04-17T14:36:55+08:00">2019-04-17</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Java/Spring-Boot/" itemprop="url" rel="index"><span itemprop="name">Spring Boot</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="一、搭建基本环境"><a href="#一、搭建基本环境" class="headerlink" title="一、搭建基本环境"></a>一、搭建基本环境</h3><p>1、导入数据库文件 创建出department和employee表<br> 2、创建JavaBean封装数据<br> 3、整合mybatis操作数据库<br>          1、配置数据源信息<br>          2、使用注解版的Mybatis<br>              1）、@MapperScan指定需要扫描的mapper接口所在的包</p>
<h3 id="二、快速体验缓存"><a href="#二、快速体验缓存" class="headerlink" title="二、快速体验缓存"></a>二、快速体验缓存</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">    步骤：</span><br><span class="line"></span><br><span class="line">        1、开启基于注解的缓存    @EnableCaching</span><br><span class="line">        2、标注缓存注解即可</span><br><span class="line">            @Cacheable  将方法的运行结果进行缓存，以后再要相同的数据，直接从缓存中获取，不在调用方法</span><br><span class="line">                    CacheManager管理多个Cache组件的，对缓存的真正CRUD操作在Cache组件中，每一个缓存组件有自己唯一的名字；</span><br><span class="line">                    几个属性：</span><br><span class="line">                        cacheNames/value: 指定缓存组件的名字</span><br><span class="line">                       key：缓存数据使用的key，可以用它指定，默认是使用方法参数的值 1-方法返回值</span><br><span class="line">                           编写SpEL：#id：参数id的值 #a0   #p0  #root.args[0]</span><br><span class="line">                           @Cacheable(cacheName = &quot;emp&quot;, key=&quot;#id&quot;)</span><br><span class="line">                        keyGenerator: key的生成器；也可以自己指定key的生成器的组件id</span><br><span class="line">                            key/keyGenerator：二选一使用</span><br><span class="line">                       cacheManager：指定缓存管理器；或者cacheResolver指定获取解析器</span><br><span class="line">                        condition：指定符合条件的情况下才缓存；</span><br><span class="line">                            例：    @Cacheable(cacheName = &quot;emp&quot;, condition=&quot;#id&gt;0&quot;)</span><br><span class="line">                        unless: 否定缓存，当unless指定的条件为true，方法的返回值就不会被缓存；可以获取的结果进行判断</span><br><span class="line">                        sync：是否使用异步模式</span><br><span class="line">               原理：</span><br><span class="line">                   1、自动配置类：CacheAutoConfiguration</span><br><span class="line">                   2、缓存的配置类</span><br><span class="line">                   3、哪个配置类默认生效：Simple</span><br><span class="line">                   4、给容器中注册了一个CacheManager，ConcurrentMapCacheManager</span><br><span class="line">                   5、可以获取和创建ConcurrentMapCache类型的缓存组件；他的作用将数据保存在ConcurrentMap中；</span><br><span class="line">               运行流程：</span><br><span class="line">               @Cacheable：</span><br><span class="line">                   1、方法运行之前，先去查询Cache（缓存组件），按照cacheName指定的名字获取；</span><br><span class="line">                       （CacheManager先获取相应的缓存），第一次获取缓存如果没有Cache组件会自动创建。</span><br><span class="line">                   2、去Cache中查找缓存的内容，使用一个key，默认就是方法的参数</span><br><span class="line">           @CacheEvict 清除缓存</span><br><span class="line">                key：指定要清除的数据</span><br><span class="line">·                allEntries = true 指定清除这个缓存中所以的数据</span><br><span class="line">                beforeInvocation = false；缓存的清除是否在方法之前执行，默认代表缓存清除操作是在方法执行之后执行；如果出现异常不会清除、</span><br><span class="line"></span><br><span class="line">           @CachePut： 既调用方法，又更新缓存数据；同步更新缓存</span><br><span class="line">                修改了数据库的某个数据，同时更新缓存</span><br><span class="line">               key：指定要更新的数据</span><br><span class="line"></span><br><span class="line">            @Caching(   //定义复杂缓存规则</span><br><span class="line">               cacheable = &#123;</span><br><span class="line">                      @Cacheable(value=&quot;emp&quot;, key=&quot;#lastName&quot;)</span><br><span class="line">               &#125;,</span><br><span class="line">               put = &#123;</span><br><span class="line">                    @CachePut(value=&quot;emp&quot;, key=&quot;#result.id&quot;),</span><br><span class="line">                   @CachePut(value=&quot;emp&quot;, key=&quot;#result.email&quot;)</span><br><span class="line">               &#125;</span><br><span class="line">           )</span><br><span class="line"></span><br><span class="line">        @CacheConfig(cacheName=&quot;emp&quot;)  //注在类上,抽取缓存的公共配置</span><br></pre></td></tr></table></figure>
<h3 id="三、整合redis作为缓存"><a href="#三、整合redis作为缓存" class="headerlink" title="三、整合redis作为缓存"></a>三、整合redis作为缓存</h3><p>Redis是一个开源（BSD许可）的，内存中的数据结构储存系统，它可以用作数据库、缓存和消息中间件。</p>
<p><strong>1、安装redis，使用docker；</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker images 查看</span><br><span class="line"></span><br><span class="line">docker pull registry.docker-cn.com/library/redis    docker下载redis镜像</span><br><span class="line"></span><br><span class="line">docker run -d -p 6376:6379  --name myredis + 镜像名     说明：  -d：后台启动；-p：暴露端口；6379映射                            到6379；重命名的镜像名myredis</span><br></pre></td></tr></table></figure>
<p><strong>2、引入redis的starter；</strong></p>
<p><strong>3、配置redis</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">@Autowired</span><br><span class="line">StringRedisTemplate stringRedisTemplate; //操作k-v都是字符串的</span><br><span class="line">@Autowired</span><br><span class="line">RedisTemplate redisTemplate; //k-v都是对象的   </span><br><span class="line"></span><br><span class="line">Redis常见的五大数据类型</span><br><span class="line">     *     String（字符串）、List（列表）、Set（集合）、Hash（散列）、ZSet（有序集合）</span><br><span class="line">     *     stringRedisTemplate.opsForValue() [String（字符串）]</span><br><span class="line">     *     stringRedisTemplate.opsForList() [List（列表）]</span><br><span class="line">     *     stringRedisTemplate.opsForSet() [Set（集合）]</span><br><span class="line">     *     stringRedisTemplate.opsForHash() [Hash（散列）]</span><br><span class="line">     *     stringRedisTemplate.opsForZSet() [ZSet（有序集合）]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//给redis中保存数据</span><br><span class="line">stringRedisTemplate.opsForValue().append(&quot;mgs&quot;, &quot;hello&quot;);</span><br><span class="line">//从redis读数据</span><br><span class="line">String msg = stringRedisTemplate.opsForValue().get(&quot;msg&quot;);</span><br><span class="line">System.out.println(msg);</span><br><span class="line"></span><br><span class="line">stringRedisTemplate.opsForList().leftPush(&quot;mylist&quot;, &quot;1&quot;);</span><br><span class="line">stringRedisTemplate.opsForList().leftPush(&quot;mylist&quot;, &quot;2&quot;);</span><br><span class="line"></span><br><span class="line">//测试保存对象</span><br><span class="line">@Autowired</span><br><span class="line">RedisTemplate&lt;Object, Employee&gt; EmpRedisTemplate; //自定义config序列化对象</span><br><span class="line"></span><br><span class="line">        Employee employee = new Employee();</span><br><span class="line">        //默认如果保存对象，使用序列化机制，序列化后的数据保存到redis中</span><br><span class="line">        //redisTemplate.opsForValue().set(&quot;emp-01&quot;, employee);</span><br><span class="line">        /**</span><br><span class="line">         * 1、将数据以json的方式保存</span><br><span class="line">         （1）、自己将对象转为json</span><br><span class="line">         （2）、redisTemplate默认的序列化规则;改变默认的序列化规则</span><br><span class="line">         */</span><br><span class="line">        EmpRedisTemplate.opsForValue().set(&quot;emp-01&quot;, employee);</span><br></pre></td></tr></table></figure>
<p>自定义RedisConfig</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">public class redisConfig &#123;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public RedisTemplate&lt;Object, Employee&gt; redisTemplate(</span><br><span class="line">            RedisConnectionFactory redisConnectionFactory)</span><br><span class="line">        throws UnknownHostException&#123;</span><br><span class="line">        RedisTemplate&lt;Object, Employee&gt; template = new RedisTemplate&lt;&gt;();</span><br><span class="line">        template.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">        //序列化器</span><br><span class="line">        Jackson2JsonRedisSerializer&lt;Employee&gt; serializer = new Jackson2JsonRedisSerializer&lt;Employee&gt;(Employee.class);</span><br><span class="line">        template.setDefaultSerializer(serializer);</span><br><span class="line">        return template;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>4、测试缓存</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">原理：CacheManager===Cache 缓存组件来实际给缓存中存取数据</span><br><span class="line"></span><br><span class="line">1）、引入redis的starter，容器中保存的是RedisCacheManager；</span><br><span class="line"></span><br><span class="line">2）、RedisCacheManager 帮我们创建RedisCache 来作为缓存组件；RedisCache 通过操作redis缓存数据</span><br><span class="line"></span><br><span class="line">3）、默认保存数据 k-v 都是object；利用序列化保存；如何保存json</span><br><span class="line"></span><br><span class="line">    1、引入了redis的starter，cacheManager变为RedisCacheManager；</span><br><span class="line"></span><br><span class="line">    2、默认创建的 RedisCacheManager 操作redis的时候使用的是 RedisTemplate&lt;Object, Object&gt;</span><br><span class="line"></span><br><span class="line">    3、RedisTemplate&lt;Object, Object&gt; 是默认使用jdk的序列化机制</span><br><span class="line"></span><br><span class="line">4）、自定义cacheManager</span><br></pre></td></tr></table></figure>
<h3 id="四、rabbitmq"><a href="#四、rabbitmq" class="headerlink" title="四、rabbitmq"></a>四、rabbitmq</h3><p><strong>1、安装rabbitmq，使用docker；</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker images 查看</span><br><span class="line"></span><br><span class="line">docker pull registry.docker-cn.com/library/rabbitmq: 3-management    docker下载redis镜像</span><br><span class="line"></span><br><span class="line">docker run -d -p 5672:5672  -p 15672:15672 --name myrabbitmq + 镜像名     说明：  -d：后台启动；-p：暴露端口；5672映射到5672；15672映射到15672；重命名的镜像名myrabbitmq</span><br></pre></td></tr></table></figure>
<p><strong>2、引入redis的starter；</strong></p>
<p><strong>3、配置redis</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">自动配置</span><br><span class="line"></span><br><span class="line">1、RabbitAutoConfiguration；</span><br><span class="line"></span><br><span class="line">2、有自动配置了连接工厂ConnectionFactory；</span><br><span class="line"></span><br><span class="line">3、RabbitProperties封装了 RabbitMq的配置</span><br><span class="line"></span><br><span class="line">4、RabbitTemplate：给RabbitMQ发送和接收消息</span><br><span class="line"></span><br><span class="line">5、AmqpAdmin：RabbitMQ系统管理功能组件</span><br><span class="line"></span><br><span class="line">6、@EnableRabbit + @RabbitListener 监听消息队列内容</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">@Autowired</span><br><span class="line">    RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    AmqpAdmin amqpAdmin;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void createExchange() &#123;</span><br><span class="line">        //amqpAdmin.declareExchange(new DirectExchange(&quot;amqpadmin.exchange&quot;));</span><br><span class="line">        //System.out.println(&quot;创建完成&quot;);</span><br><span class="line"></span><br><span class="line">        amqpAdmin.declareQueue(new Queue(&quot;amqpadmin.queue&quot;, true));</span><br><span class="line"></span><br><span class="line">        //创建绑定规则</span><br><span class="line">        amqpAdmin.declareBinding(new Binding(&quot;amqpadmin.queue&quot;, Binding.DestinationType.QUEUE, &quot;amqpadmin.exchange&quot;, &quot;amqp.name&quot;, null));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 1、单播（点对点）</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void contextLoads() &#123;</span><br><span class="line">        //Message需要自己构造一个，定义消息体内容和消息头</span><br><span class="line">        //rabbitTemplate.send(exchage, routeKey, message);</span><br><span class="line"></span><br><span class="line">        //object默认当成消息体，只需要传入要发送的对象，自动序列化发送给rabbitmq；</span><br><span class="line">        //rabbitTemplate.convertAndSend(exchage, routeKey, object);</span><br><span class="line">        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();</span><br><span class="line">        map.put(&quot;msg&quot;, &quot;这是一个消息&quot;);</span><br><span class="line">        map.put(&quot;data&quot;, Arrays.asList(&quot;helloWorld&quot;, 123, true));</span><br><span class="line">        //对象被默认序列化以后发送出去</span><br><span class="line">        //rabbitTemplate.convertAndSend(&quot;exchange.direct&quot;, &quot;example.news&quot;, map);</span><br><span class="line">        rabbitTemplate.convertAndSend(&quot;exchange.direct&quot;, &quot;example.news&quot;, new Book(&quot;西游记&quot;, &quot;吴承恩&quot;));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //接收数据，如何将数据自动转为json发送出去</span><br><span class="line">    @Test</span><br><span class="line">    public void receive() &#123;</span><br><span class="line">        Object o = rabbitTemplate.receiveAndConvert(&quot;exchange.direct&quot;);</span><br><span class="line">        System.out.println(o.getClass());</span><br><span class="line">        System.out.println(o);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 广播</span><br><span class="line">     */</span><br><span class="line">    public void sendMSg() &#123;</span><br><span class="line">        rabbitTemplate.convertAndSend(&quot;exchange.fanout&quot;, &quot;&quot;, new Book(&quot;三国演义&quot;, &quot;罗贯中&quot;));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>config</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">public class MyAMQPConfig &#123;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public MessageConverter messageConverter() &#123;</span><br><span class="line">        return new Jackson2JsonMessageConverter();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="五、检索"><a href="#五、检索" class="headerlink" title="五、检索"></a>五、检索</h3><p><strong>1、安装ElasticSearch，使用docker；</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker images 查看</span><br><span class="line"></span><br><span class="line">docker pull registry.docker-cn.com/library/elasticsearch    docker下载redis镜像</span><br><span class="line"></span><br><span class="line">docker run -e ES_JAVA_OPTS=&quot;-Xms256m -Xms256m&quot; -d -p 9200:9200 -p9300:9300 --name ES01 + 镜像名     说明：  -e：限制内存使用；-d：后台启动；-p：暴露端口；9200映射到9200；9300 映射到9300 ；重命名的镜像名ES01</span><br></pre></td></tr></table></figure>
<p><strong>2、引入ElasticSearch的starter；</strong></p>
<p><strong>3、配置ElasticSearch</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SpringBoot 默认支持两种技术来和ES交互</span><br><span class="line"></span><br><span class="line">    1、Jest（默认不生效）</span><br><span class="line"></span><br><span class="line">        需要导入jest的工具包（ io.searchbox.client.JestClient）</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- https://mvnrepository.com/artifact/io.searchbox/jest --&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;io.searchbox&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;jest&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;5.3.3&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">2、SpringData ElasticSearch【ES版本有可能不合适】</span><br><span class="line"></span><br><span class="line">    [版本适配说明](https://github.com/spring-projects/spring-data-elasticsearch)</span><br><span class="line"></span><br><span class="line">    如果版本不适配：</span><br><span class="line"></span><br><span class="line">        1）、升级springboot 版本</span><br><span class="line"></span><br><span class="line">        2）、安装对应版本的ES</span><br><span class="line"></span><br><span class="line">    1）、Client 节点信息clusterNodes、clusterName</span><br><span class="line"></span><br><span class="line">    2）、ElasticsearchTemplate 操作Es</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">@Autowired</span><br><span class="line">    JestClient jestClient;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void contextLoads() &#123;</span><br><span class="line">        //1、给Es中索引（保存）一个文档</span><br><span class="line">        Article article = new Article();</span><br><span class="line">        article.setId(1);</span><br><span class="line">        article.setTitle(&quot;好消息&quot;);</span><br><span class="line">        article.setAuthor(&quot;zhangsan&quot;);</span><br><span class="line">        article.setContent(&quot;Hello World!&quot;);</span><br><span class="line"></span><br><span class="line">        //构建一个索引功能</span><br><span class="line">        Index index = new Index.Builder(article).index(&quot;atguigu&quot;).type(&quot;news&quot;).build();</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line">            //执行</span><br><span class="line">            jestClient.execute(index);</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //测试搜索</span><br><span class="line">    @Test</span><br><span class="line">    public void search() &#123;</span><br><span class="line">        String json = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">        //构建搜索功能</span><br><span class="line">        Search search = new Search.Builder(json).addIndex(&quot;atguigu&quot;).addType(&quot;news&quot;).build();</span><br><span class="line"></span><br><span class="line">        //执行</span><br><span class="line">        try &#123;</span><br><span class="line">            SearchResult result = jestClient.execute(search);</span><br><span class="line">            System.out.println(result.getJsonString());</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/searchbox-io/Jest/tree/master/jest" target="_blank" rel="noopener">参考文档</a></p>
<h3 id="六、任务"><a href="#六、任务" class="headerlink" title="六、任务"></a>六、任务</h3><p>1、异步任务</p>
<p>在主方法上加<strong>@EnableAsync</strong>  //开启异步注解功能</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@EnableAsync  //开启异步注解功能</span><br><span class="line">@SpringBootApplication</span><br><span class="line">public class Springboot04TaskApplication &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        SpringApplication.run(Springboot04TaskApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>方法上加<strong>@Async</strong>  //告诉spring这是个异步方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@Service</span><br><span class="line">public class AsyncService &#123;</span><br><span class="line">    @Async  //告诉spring这是个异步方法</span><br><span class="line">    public void hello() &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            Thread.sleep(3000);</span><br><span class="line">        &#125; catch (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(&quot;处理数据中...&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2、定时任务</p>
<p>在主方法开启定时任务<strong>@EnableScheduling</strong> //开启基于注解的定时任务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@EnableScheduling //开启基于注解的定时任务</span><br><span class="line">@SpringBootApplication</span><br><span class="line">public class Springboot04TaskApplication &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        SpringApplication.run(Springboot04TaskApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在方法上使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">@Service</span><br><span class="line">public class ScheduledService &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * second(秒)、minute（分）、hour（时）、day of month（日）、month（月）、day of week（周几）</span><br><span class="line">     * 0 * * * * MON-FRI</span><br><span class="line">     * 【0 0/5 14，18 * * ？】 每天14点整，和18点整，每隔5秒执行一次</span><br><span class="line">     * 【0 15 10 ？ * 1-6】 每个月的周一到周六10：15分执行一次</span><br><span class="line">     * 【0 0 2 ？ * 6L】 每个月的最后一个周六凌晨2点执行一次</span><br><span class="line">     * 【0 0 2 LW * ？】 每个月的最后一个工作日凌晨2点执行一次</span><br><span class="line">     * 【0 0 2-4 ？ * 1#1】 每个月的第一个周一凌晨2点到4点期间，每个整点执行一次</span><br><span class="line">     */</span><br><span class="line">    //@Scheduled(cron = &quot;0 * * * * MON-SAT&quot;)</span><br><span class="line">    //@Scheduled(cron = &quot;0,1,2,3,4 * * * * MON-SAT&quot;)  //枚举</span><br><span class="line">    //@Scheduled(cron = &quot;0-4 * * * * MON-SAT&quot;)</span><br><span class="line">    @Scheduled(cron = &quot;0/4 * * * * MON-SAT&quot;)  //梅4秒执行一次</span><br><span class="line">    public void hello() &#123;</span><br><span class="line">        System.out.println(&quot;hello...&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3、邮件任务</p>
<p>引入starter依赖</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>配置文件application.properties</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">spring.mail.username=jaunelau@qq.com</span><br><span class="line">spring.mail.password=aaaaa  #授权码</span><br><span class="line">spring.mail.host=smtp.qq.com</span><br><span class="line">spring.mail.properties.mail.smtp.ssl.enable=true  # 开启ssl</span><br></pre></td></tr></table></figure>
<p>测试</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">@Autowired</span><br><span class="line">    JavaMailSenderImpl mailSender;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void contextLoads() &#123;</span><br><span class="line">        SimpleMailMessage mailMessage = new SimpleMailMessage();</span><br><span class="line">        //邮件设置</span><br><span class="line">        mailMessage.setSubject(&quot;通知今晚开户&quot;);</span><br><span class="line">        mailMessage.setText(&quot;今晚7：30开会&quot;);</span><br><span class="line"></span><br><span class="line">        mailMessage.setTo(&quot;123@qq.com&quot;);</span><br><span class="line">        mailMessage.setFrom(&quot;456@qq.com&quot;);</span><br><span class="line">        mailSender.send(mailMessage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void test02() throws MessagingException &#123;</span><br><span class="line">        //1、创建一个复杂的消息邮件</span><br><span class="line">        MimeMessage mailMessage = mailSender.createMimeMessage();</span><br><span class="line">        MimeMessageHelper helper = new MimeMessageHelper(mailMessage, true);</span><br><span class="line">        //邮件设置</span><br><span class="line">        helper.setSubject(&quot;通知今晚开户&quot;);</span><br><span class="line">        helper.setText(&quot;&lt;b&gt;今晚7：30开会&lt;/b&gt;&quot;, true);</span><br><span class="line"></span><br><span class="line">        helper.setTo(&quot;123@qq.com&quot;);</span><br><span class="line">        helper.setFrom(&quot;456@qq.com&quot;);</span><br><span class="line"></span><br><span class="line">        //上传文件</span><br><span class="line">        helper.addAttachment(&quot;1.jpg&quot;, new File(&quot;c:\\图片&quot;));</span><br><span class="line">        helper.addAttachment(&quot;2.jpg&quot;, new File(&quot;&quot;));</span><br><span class="line">        mailSender.send(mailMessage);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="七、安全"><a href="#七、安全" class="headerlink" title="七、安全"></a>七、安全</h3><p><strong>SpringSecurity</strong></p>
<p>1、引入SpringSecurity；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>2、编写SpringSecurity的配置类；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@EnableWebSecurity</span><br><span class="line">public class MySecurityConfig extends WebSecurityConfigurerAdapter &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3、控制请求的访问权限；</p>
<p><strong>Ctrl+O打开可重写的方法</strong></p>
<p>修改引入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- https://mvnrepository.com/artifact/org.thymeleaf.extras/thymeleaf-extras-springsecurity4 --&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.thymeleaf.extras&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;thymeleaf-extras-springsecurity4&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>config配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">@EnableWebSecurity</span><br><span class="line">public class MySecurityConfig extends WebSecurityConfigurerAdapter &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void configure(HttpSecurity http) throws Exception &#123;</span><br><span class="line">        //super.configure(http);</span><br><span class="line">        //定制请求的授权规则</span><br><span class="line">        http.authorizeRequests().antMatchers(&quot;/&quot;).permitAll()</span><br><span class="line">                .antMatchers(&quot;/level1/**&quot;).hasRole(&quot;VIP1&quot;)</span><br><span class="line">                .antMatchers(&quot;/level2/**&quot;).hasRole(&quot;VIP2&quot;)</span><br><span class="line">                .antMatchers(&quot;/level3/**&quot;).hasRole(&quot;VIP3&quot;);</span><br><span class="line"></span><br><span class="line">        //开启自动配置的登陆功能；效果：如果没有登陆，没有权限就会来到登陆页面</span><br><span class="line">        http.formLogin().usernameParameter(&quot;user&quot;).passwordParameter(&quot;password&quot;)</span><br><span class="line">                .loginPage(&quot;/userlogin&quot;);</span><br><span class="line">        //1、/login来到登陆页</span><br><span class="line">        //2、重定向到/login？error表示登陆失败</span><br><span class="line">        //3、更多详细规则</span><br><span class="line">        //4、默认post形式的/login代表处理登陆</span><br><span class="line">        //5、一旦定制LoginPage；那么LoginPage的post请求就是登陆</span><br><span class="line"></span><br><span class="line">        //开启自动配置的注销功能</span><br><span class="line">        http.logout().logoutSuccessUrl(&quot;/&quot;); //注销成功以后来到首页</span><br><span class="line">        //1、访问/logout 表示用户注销，清空session</span><br><span class="line">        //2、注销成功会返回 /login?logout 页面</span><br><span class="line"></span><br><span class="line">        //开启记住我功能</span><br><span class="line">        http.rememberMe().rememberMeParameter(&quot;remember&quot;);</span><br><span class="line">        //登陆成功后，将cookie发给浏览器保存，以后访问页面带上这个cookie，只要通过检查就可以免登陆</span><br><span class="line">        //点击注销会删除cookie</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //定义认证规则</span><br><span class="line">    @Override</span><br><span class="line">    protected void configure(AuthenticationManagerBuilder auth) throws Exception &#123;</span><br><span class="line">        //super.configure(auth);</span><br><span class="line">        auth.inMemoryAuthentication()</span><br><span class="line">                .withUser(&quot;zhangsan&quot;).password(&quot;123456&quot;).roles(&quot;VIP1&quot;, &quot;VIP2&quot;)</span><br><span class="line">                .and()</span><br><span class="line">                .withUser(&quot;lisi&quot;).password(&quot;123456&quot;).roles(&quot;VIP2&quot;, &quot;VIP3&quot;)</span><br><span class="line">                .and()</span><br><span class="line">                .withUser(&quot;wangwu&quot;).password(&quot;123456&quot;).roles(&quot;VIP1&quot;, &quot;VIP3&quot;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>页面templates/index.html</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;form th:action=&quot;@&#123;/userlogin&#125;&quot; method=&quot;post&quot;&gt;</span><br><span class="line">            用户名：&lt;input name=&quot;user&quot;&gt;&lt;br&gt;</span><br><span class="line">            密码：&lt;input name=&quot;password&quot;&gt;&lt;br&gt;</span><br><span class="line">            &lt;input type=&quot;checkbox&quot; name=&quot;remember&quot;&gt;</span><br><span class="line">            &lt;input type=&quot;submit&quot; value=&quot;登陆&quot; /&gt;</span><br><span class="line">        &lt;/form&gt;</span><br></pre></td></tr></table></figure>
<h3 id="八、分布式"><a href="#八、分布式" class="headerlink" title="八、分布式"></a>八、分布式</h3><h4 id="1、dubbo和zookeeper"><a href="#1、dubbo和zookeeper" class="headerlink" title="1、dubbo和zookeeper"></a>1、dubbo和zookeeper</h4><p>1）、安装zookeeper，使用docker；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker images 查看</span><br><span class="line"></span><br><span class="line">docker pull registry.docker-cn.com/library/zookeeper     docker下载redis镜像</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker run --name some-zookeeper -p 2181:2181 --restart always -d zookeeper +镜像名</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[参考](https://hub.docker.com/_/zookeeper/)</span><br></pre></td></tr></table></figure>
<p>2）、引入依赖(两个项目都引用)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;com.alibaba.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;dubbo-spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;0.1.0&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!--引入zookeeper的客户端工具--&gt;</span><br><span class="line">        &lt;!-- https://mvnrepository.com/artifact/com.github.sgroschupf/zkclient --&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;com.github.sgroschupf&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;zkclient&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;0.1&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>provider-ticket项目</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1、将服务提供者注册到注册中心</span><br><span class="line">*  1、引入dubbo和zkclient相关依赖</span><br><span class="line">*  2、配置dubbo的扫描包和注册中心地址</span><br><span class="line">*  3、使用@Service发布服务</span><br></pre></td></tr></table></figure>
<p>接口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface TicketService &#123;</span><br><span class="line"></span><br><span class="line">    public String getTicket();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>接口的实现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import com.alibaba.dubbo.config.annotation.Service;</span><br><span class="line"></span><br><span class="line">@Component  //注册为组件</span><br><span class="line">@Service  //将服务发布出去，注意service的引用dubbo</span><br><span class="line">public class TicketServiceImpl implements TicketService &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public String getTicket() &#123;</span><br><span class="line">        return &quot;《厉害了，我的国》&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>配置文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dubbo.application.name=provider-ticket</span><br><span class="line"></span><br><span class="line">dubbo.registry.address=zookeeper://127.0.0.1:2181</span><br><span class="line"></span><br><span class="line">dubbo.scan.base-packages=com.example.ticket.service</span><br></pre></td></tr></table></figure>
<p>consumer-user项目</p>
<p>应用依赖；</p>
<p>创建和<strong>provider-ticket项目</strong>相同路径的service接口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface TicketService &#123;</span><br><span class="line"></span><br><span class="line">    public String getTicket();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>自己的service</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@Service</span><br><span class="line">public class UserService &#123;</span><br><span class="line"></span><br><span class="line">    @Reference  //引用它的实现</span><br><span class="line">    TicketService ticketService;</span><br><span class="line"></span><br><span class="line">    public void hello() &#123;</span><br><span class="line">        String ticket = ticketService.getTicket();</span><br><span class="line">        System.out.println(&quot;买到票了：&quot; + ticket);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>配置文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dubbo.application.name=consumer-user</span><br><span class="line"></span><br><span class="line">dubbo.registry.address=zookeeper://127.0.0.1:2181</span><br></pre></td></tr></table></figure>
<p>测试</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Autowired</span><br><span class="line">    UserService userService;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void contextLoads() &#123;</span><br><span class="line">        userService.hello();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h4 id="2、Spring-Boot和Spring-Cloud"><a href="#2、Spring-Boot和Spring-Cloud" class="headerlink" title="2、Spring Boot和Spring Cloud"></a>2、Spring Boot和Spring Cloud</h4><p><img src alt="1527215177046"></p>
<p>1、新建eureka-server项目，选择Cloud Discovery-&gt;Eureka Server</p>
<p>配置文件application.yml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">server:</span><br><span class="line">  port: 8761</span><br><span class="line">eureka:</span><br><span class="line">  instance:</span><br><span class="line">    hostname: eureka-server  # eureka 实例的主机名</span><br><span class="line">  client:</span><br><span class="line">    register-with-eureka: false  # 不把自己注册到eureka上</span><br><span class="line">    fetch-registry: false   # 不从eureka上来获取服务的注册信息</span><br><span class="line">    service-url:</span><br><span class="line">      defaultZone: http://localhost:8761/eureka/  # 注册中心服务注册的地址</span><br></pre></td></tr></table></figure>
<p>主程序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">* 注册中心</span><br><span class="line">* 1、配置eureka信息</span><br><span class="line">* 2、主程序上加上@EnableEurekaServer注解</span><br><span class="line">*/</span><br><span class="line">@EnableEurekaServer</span><br><span class="line">@SpringBootApplication</span><br><span class="line">public class EurekaServerApplication &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        SpringApplication.run(EurekaServerApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2、新建provider-ticket项目，选择Cloud Discovery-&gt;Eureka Discovery</p>
<p>配置文件application.yml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">server:</span><br><span class="line">  port: 8001</span><br><span class="line">spring:</span><br><span class="line">  application:</span><br><span class="line">    name: provider-ticket</span><br><span class="line"></span><br><span class="line">eureka:</span><br><span class="line">  instance:</span><br><span class="line">    prefer-ip-address: true  # 注册服务的时候使用服务的ip地址</span><br><span class="line">  client:</span><br><span class="line">    service-url:</span><br><span class="line">      defaultZone: http://localhost:8761/eureka/  # 注册中心服务注册的地址</span><br></pre></td></tr></table></figure>
<p>service</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@Service</span><br><span class="line">public class TicketService &#123;</span><br><span class="line"></span><br><span class="line">    public String getTicket() &#123;</span><br><span class="line">        System.out.println(&quot;8001&quot;);</span><br><span class="line">        return &quot;《厉害了，我的国》&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>controller</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">public class TicketController &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    TicketService ticketService;</span><br><span class="line"></span><br><span class="line">    @GetMapping(&quot;/ticket&quot;)</span><br><span class="line">    public String getTicket() &#123;</span><br><span class="line">        return ticketService.getTicket();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3、新建consumer-user项目，选择Cloud Discovery-&gt;Eureka Discovery</p>
<p>配置文件application.yml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  application:</span><br><span class="line">    name: consumer-user</span><br><span class="line">server:</span><br><span class="line">  port: 8200</span><br><span class="line"></span><br><span class="line">eureka:</span><br><span class="line">  instance:</span><br><span class="line">    prefer-ip-address: true  # 注册服务的时候使用服务的ip地址</span><br><span class="line">  client:</span><br><span class="line">    service-url:</span><br><span class="line">      defaultZone: http://localhost:8761/eureka/  # 注册中心服务注册的地址</span><br></pre></td></tr></table></figure>
<p>controller</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">public class UserController &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    RestTemplate restTemplate;</span><br><span class="line"></span><br><span class="line">    @GetMapping(&quot;buy&quot;)</span><br><span class="line">    public String buyTicket(String name) &#123;</span><br><span class="line">        String forObject = restTemplate.getForObject(&quot;http://PROVIDER-TICKET/ticket&quot;, String.class);</span><br><span class="line">        return name + &quot;购买了&quot; + forObject;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>主程序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@EnableDiscoveryClient  //开启发现注册功能</span><br><span class="line">@SpringBootApplication</span><br><span class="line">public class ConsumerUserApplication &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        SpringApplication.run(ConsumerUserApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @LoadBalanced  //使用负载均衡机制</span><br><span class="line">    @Bean</span><br><span class="line">    public RestTemplate restTemplate() &#123;</span><br><span class="line">        return new RestTemplate();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">项目：springboot-06-springcloud</span><br></pre></td></tr></table></figure>
<h3 id="九、Spring-Boot-与-开发热部署"><a href="#九、Spring-Boot-与-开发热部署" class="headerlink" title="九、Spring Boot 与 开发热部署"></a>九、Spring Boot 与 开发热部署</h3><p>引入<strong>Developer tools</strong>依赖</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;</span><br><span class="line">        &lt;optional&gt;true&lt;/optional&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>Ctrl + F9（Build Product）：重新编译</p>
<h3 id="十、监控管理"><a href="#十、监控管理" class="headerlink" title="十、监控管理"></a>十、监控管理</h3><p>步骤：</p>
<p>1、引入spring-boot-starter-actuator依赖</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>2、通过http方式访问监控端点</p>
<p>3、可进行shutdown（POST提交，此端点默认关闭）</p>
<p>将源码托管给gitHup，<strong>GitProperties</strong>配置类它继承了<strong>InfoProperties</strong>里面的属性都能用</p>
<p><strong>git.properties配置文件</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git.branch=master</span><br><span class="line">git.commit.id=xjkd33s</span><br><span class="line">git.commit.time=2017-12-12 12:12:56</span><br></pre></td></tr></table></figure>
<p>浏览器访问：<a href="http://localhost:8080/info" target="_blank" rel="noopener">http://localhost:8080/info</a> 可以查看信息</p>
<p>application.properties配置文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">management.security.enabled=false</span><br><span class="line"></span><br><span class="line">info.app.id=hello</span><br><span class="line">info..app.version=1.0.0</span><br><span class="line"></span><br><span class="line"># endpoints.metrics.enabled=false</span><br><span class="line"># 修改端点名beans-&gt; myBean</span><br><span class="line">endpoints.beans.id=myBean</span><br><span class="line">endpoints.beans.path=/bean</span><br><span class="line"># 关闭端点</span><br><span class="line"># endpoints.beans.enabled=false</span><br><span class="line"></span><br><span class="line"># 修改端点名</span><br><span class="line">endpoints.dump.path=/du</span><br><span class="line"></span><br><span class="line"># 关闭所有的端点访问</span><br><span class="line">endpoints.enabled=false</span><br><span class="line"># 只启用beans</span><br><span class="line">endpoints.beans.enabled=true</span><br><span class="line"></span><br><span class="line"># 定制端点访问根路径</span><br><span class="line">management.context-path=/manage</span><br><span class="line"></span><br><span class="line"># 关闭http端点</span><br><span class="line"># management.port=-1</span><br><span class="line"># 修改端点</span><br><span class="line">management.port=8181</span><br><span class="line"></span><br><span class="line"># http://localhost:8080/health 在浏览器访问返回建康状态</span><br><span class="line"></span><br><span class="line"># spring.redis.host=localhost</span><br></pre></td></tr></table></figure>
<p>自定义建康状态指示器<br> 1、编写一个指示器 实现HealthIndicator 接口<br> 2、指示器的名字 xxxHealthIndicator<br> 3、加入容器中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Component</span><br><span class="line">public class myAppHealthIndicator implements HealthIndicator &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public Health health() &#123;</span><br><span class="line">        //自定义的检查方法</span><br><span class="line">        //Health.up().build() 代表建康</span><br><span class="line">        return Health.down().withDetail(&quot;msg&quot;, &quot;服务异常&quot;).build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    

    
    
    

	<div>
      
	</div>

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="Jaune lau">
            
              <p class="site-author-name" itemprop="name">Jaune lau</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">13</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">14</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">17</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:jaunelau@qq.com" title="E-Mail &rarr; mailto:jaunelau@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jaune lau</span>

  

  
</div>


  <div class="powered-by"></div>



  <span class="post-meta-divider"></span>



  <div class="theme-info"></div>




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="Total Visitors">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="post-meta-divider">|</span>
  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="Total Views">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    

    

    

    
  </a></div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.0"></script>

  <script src="/js/motion.js?v=7.1.0"></script>



  
  


  <script src="/js/affix.js?v=7.1.0"></script>

  <script src="/js/schemes/pisces.js?v=7.1.0"></script>



  

  


  <script src="/js/next-boot.js?v=7.1.0"></script>


  

  

  

  



  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
  
<script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>

</body>
</html>
<!-- 页面点击小红心 -->
<!-- <script type="text/javascript" src="/js/src/love.js"></script>-->
